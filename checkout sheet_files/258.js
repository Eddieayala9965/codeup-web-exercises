 if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas-gov.us/js-bootstrap.js?saasId=11394&type=WORKER&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas-gov.us/js-bootstrap.js?saasId=11394&type=WINDOW&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[258],{5991:function(e,t,n){"use strict";n.r(t),n.d(t,"officeHeaders",function(){return D}),n.d(t,"resourceKey",function(){return I});var a=n(0),i=n(94),r=n(2225),o=n(109),s=n(57),c=n(146),d=n(2388),l=n(290),u=n(356),f=n(2255),p=n(597),m=n(51),_=n(2533),h=n(158),b=n(947),g=n(30),v=n(4),y=n(224),S=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t)||this,i=n.invokeApi,r=n.pageContext;if(i)a._invokeApi=i;else{var o=n.dataRequestorType;a._dataRequestor=new o({qosName:"MruRecentDataSource"})}return a._engagement=n.engagement,a._identityDataSource=n.identityDataSource,a._itemParentHelper=n.itemParentHelper,a._itemUrlHelper=n.itemUrlHelper,a._ocsApiBaseUrl="".concat(r.msMruEndpointUrl,"/ocs/v2/recent"),a._tenantId=Object(c.normalizeLower)(r.aadTenantId),a}return Object(a.__extends)(t,e),t.prototype.removeRecentItem=function(e){return o.n.reject("Not implemented")},t.prototype.changePinStatus=function(e){var t=e.mruState.isPinnedToMru,n={category:"Document",type:"ClassicMru",app:Object(_.n)(e),is_pinned:!t,mru_id:e.mruState.mruId,url:e.properties.path};return this._engagement.logData({name:"MruRecent"+(t?".UnpinItem":".PinItem"),isIntentional:!0}),this._invokeApi({url:"".concat(this._ocsApiBaseUrl,"/docs"),qosName:t?"SetMRUUnpinned":"SetMRUPinned",body:n})},t.prototype.recordDocumentView=function(e,t){var n=!t.mru_id,r=this,o=r._itemParentHelper,s=r._itemUrlHelper,d=r.observables,l=o.getFacetedAncestorOrSelf(e,"list"),u=o.getFacetedAncestorOrSelf(e,"subsite"),f=d.peekUnwrap(l),p=d.peekUnwrap(u),m=e.properties,_=f&&f.list,b=p&&p.subsite,g=s.getItemUrlParts(e.key),v=s.getUrlParts({path:g.fullItemUrl,listUrl:_&&_.listUrlDir,webUrl:b&&b.serverRelativeUrl}).webRelativeItemUrl,y=new h.e(v).segments.slice(0,-1),S=b&&b.webTemplateId,D="number"==typeof S?S===i.t.mySite?"business":"documentLibrary":void 0;return t=Object(a.__assign)(Object(a.__assign)({},t),{display_path:y,onedrive_info:Object(a.__assign)({drive_type:D},t.onedrive_info),sharepoint_info:{list_id:Object(c.normalizeLower)(m.listId||_&&_.id),list_item_id:parseInt(m.ID,10),list_item_unique_id:Object(c.normalizeLower)(m.uniqueId),site_id:b&&Object(c.normalizeLower)(b.siteCollectionId),site_url:b&&b.serverRelativeUrl,tenant_id:this._tenantId,web_id:b&&Object(c.normalizeLower)(b.id)}}),this._invokeApi({url:this._ocsApiBaseUrl,qosName:"".concat(n?"Add":"Update","MRUEntry"),body:t})},t.prototype.getTokenForMru=function(){return this._identityDataSource.getOfficeToken().then(function(e){return e.accessToken})},t.prototype._invokeApi=function(e){var t=this;return this.getTokenForMru().then(function(n){if(!v.e.isActivated("A1C0D26A-2ECD-43C5-9686-E57F14E61AB9","10/5/2021","Avoid using SP DataRequestor for Office MRU Recent")){var i=new g.e({name:"MruRecentDataSource.".concat(e.qosName)});return b.e.start({url:e.url,method:"POST",headers:Object(a.__assign)({Authorization:"Bearer ".concat(n)},D),json:JSON.stringify(e.body)}).then(function(e){return i.end({resultType:g.t.Success}),JSON.parse(e.responseText)},function(e){return i.end(Object(y.e)(e)),o.n.reject(e)})}return t._dataRequestor.getData({url:e.url,method:"POST",qosName:e.qosName,needsRequestDigest:!1,noRedirect:!0,additionalHeaders:Object(a.__assign)({Authorization:"Bearer ".concat(n)},D),additionalPostData:JSON.stringify(e.body)})})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},r.n.dependencies),{dataRequestorType:d.t,engagement:p.e,identityDataSource:l.resourceKey,itemParentHelper:f.e,itemUrlHelper:u.s,pageContext:m.p}),t}(r.n);t.default=S;var D={"X-Office-Platform":"Web","X-Office-Application":"110","X-Office-Version":window._spModuleLink?window._spModuleLink.buildNumber:0,"Content-Type":"application/json;charset=UTF-8"},I=Object(s.r)("MruRecentDataSource",S)}}]);