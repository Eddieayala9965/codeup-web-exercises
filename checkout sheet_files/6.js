 if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas-gov.us/js-bootstrap.js?saasId=11394&type=WORKER&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas-gov.us/js-bootstrap.js?saasId=11394&type=WINDOW&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[6],{528:function(e,t,n){"use strict";n.d(t,"U",function(){return r.t;}),n.d(t,"t",function(){return c;}),n.d(t,"a",function(){return d;}),n.d(t,"o",function(){return l;}),n.d(t,"m",function(){return u;}),n.d(t,"p",function(){return f;}),n.d(t,"h",function(){return m;}),n.d(t,"_",function(){return _;}),n.d(t,"b",function(){return h;}),n.d(t,"k",function(){return b;}),n.d(t,"v",function(){return g;}),n.d(t,"S",function(){return v;}),n.d(t,"I",function(){return y;}),n.d(t,"x",function(){return S;}),n.d(t,"y",function(){return D;}),n.d(t,"C",function(){return I;}),n.d(t,"O",function(){return x;}),n.d(t,"w",function(){return C;}),n.d(t,"A",function(){return O;}),n.d(t,"E",function(){return w;}),n.d(t,"D",function(){return E;}),n.d(t,"L",function(){return A;}),n.d(t,"M",function(){return k;}),n.d(t,"g",function(){return M;}),n.d(t,"l",function(){return P;}),n.d(t,"u",function(){return T;}),n.d(t,"f",function(){return U;}),n.d(t,"e",function(){return F;}),n.d(t,"s",function(){return H;}),n.d(t,"d",function(){return R;}),n.d(t,"r",function(){return N;}),n.d(t,"i",function(){return B;}),n.d(t,"n",function(){return j;}),n.d(t,"F",function(){return V;}),n.d(t,"P",function(){return z;}),n.d(t,"T",function(){return K;}),n.d(t,"c",function(){return W;});var a=n(16),i=n(538),r=(window._spModuleLink&&["ODBLightSpeedWebPack","ODBOneDrive"].indexOf(window._spModuleLink.manifestName),n(531)),o=window._spModuleLink&&"MetaOSODBFileBrowserV2"===window._spModuleLink.manifestName,s=window._spModuleLink&&"ODBLightSpeedWebPack"===window._spModuleLink.manifestName,c=(window._spModuleLink&&window._spModuleLink.manifestName,i.e.isActivated("385ac127-7335-45ab-9515-8ac541286052","08/25/2023","Use service config for SWA routing enabled value"),window.Flight&&"odclightspeedwebpack"===window.Flight.manifest||window._spModuleLink&&window._spModuleLink.manifestName,i.e.isActivated("BF7BE655-7F9F-40C8-920B-C4088F784512","05/05/2022","Prefer cookie API calls using proxy in File Picker"),{ODB:1371}),d=(r.t,i.e.isActivated("95195f4e-8936-409f-bc5e-d98fad1cef73","08/18/2021","KillSwitch for consuming exposed Default click control handler in OneDriveItemsScopeApp"),{ODB:1114}),l=(!s&&r.a,i.e.isActivated("7B7FA902-74E1-41A3-B7FA-5E99A7C60744","10/25/2021","Enables the CallerId and CallerScenarioId query provided on inbound links to be logged in extra data of Page.View engagement event."),r.n,r.n,!r.n&&i.e.isActivated("3EFEFBD7-0AA5-4041-AAC2-EE0308AC532D","07/27/2023","shows the Recent pivot for migrated users"),!!r.n&&i.e.isActivated("70C000B4-CC40-4BC4-99BF-77B1C9D91115","08/01/2022","Disable photos pivot in winApp"),i.e.isActivated("728AC795-2069-44D4-B387-4B82D9E1D930","06/29/2022","Use layer projection for Sites in ODB"),i.e.isActivated("C7DDA4BE-D28B-4151-A22F-0BD7727B012D","1/26/2022","Use cross-site File Browser for Sites in ODB"),i.e.isActivated("8EC3A32A-7C43-4A5F-9AE1-74CBF2762A13","05/22/2023","Enable ODB LightSpeed in File Browser"),i.e.isActivated("E8005073-525F-4144-A49A-A249EC0F3F35"),i.e.isActivated("B29F9DC8-0A52-4F31-A513-088869FB0BB9"),i.e.isActivated("5B71E25C-79EB-46E2-A9EE-C2B81FAC35A0"),i.e.isActivated("480B5399-553E-44D1-890F-217A65B602DD","06/06/2023","Add scenario header in push channel , FRE and prefetch API calls"),{ODB:-1065}),u=(r.t,r.n,r.n,r.t,!r.n&&i.e.isActivated("5F12686F-52A2-4E49-A1D8-A2AE7969622E","10/29/2021","Use multiPart getItem api(ODC vroom) to avoid CORS if KS is not activated."),{ODB:!i.e.isActivated("DC975CAD-8F3C-4979-97E2-DA9970A68919","03/25/2022","Prefer isMySiteOwner check for ODB"),Fallback:!0}),f={ODB:!!s&&-1520},p=(r.n,void 0===n.p),m=(r.t&&!s&&!r.n&&!o||!r.t&&p&&i.e.isActivated("608E1D31-70F0-4B48-9EC3-CDCC41EA17E2","8/30/2021","Refresh the page in a SPList when closing previewer when the user is using AMD."),i.e.isActivated("9ACCAC8B-D74D-43A2-98AA-457EADAF074D","11/5/2021","Initialze logging with OAuth support"),i.e.isActivated("F7A1F6FE-3272-4B0E-AD26-70E8322C5D8F","09/15/2022","Ensure components use getDriveQuotaKey method to get the key"),i.e.isActivated("72B58EAF-775A-4B01-BFF4-A083818DDF86","05/05/2022","Use on-demand implementation for DefaultClickAction"),{ODB:60393}),_=(r.n,{ODB:90007}),h={ODB:!i.e.isActivated("00ece790-28cb-4228-b947-70c6cf959b9e","6/5/2023","Simplified Sharing Dialog v2")},b={ODB:!i.e.isActivated("4496A248-01D8-4CBC-988F-C8D3DF98E12F","09/26/2023","Use self-issued token for authentication")},g=(i.e.isActivated("5EF28CEA-01F7-4DA8-995F-00EC16D852B1","09/26/2023","Use self-issued token to authenticate zip download"),{ODB:-671}),v=(i.e.isActivated("0DEAC9E8-4230-49B1-869A-55EE7D4256FC","10/22/2021","Disable silent auth frame in ODC itemsscope for anonymous users"),{ODC:"UseItemsScopeInAllPhotosEnableIE"}),y={ODC:"UseItemsScopeInAllPhotosEnableMobile"},S={ODC:"UseItemsScopeInAllPhotosEnableSafari"},D={ODC:"UseItemsScopeInAllPhotos"},I={ODC:"UseItemsScopeInAllTags"},x={ODC:!r.n||"EnableLightspeedInOneDriveWinApp",ODB:!r.n||1413},C={ODC:"UseItemsScopeInSingleAlbum"},O={ODC:"UseItemsScopeInSingleTag"},w={ODC:"UseItemsScopeInSinglePlace"},E={ODC:"UseItemsScopeInAllPhotosEnableInFilePicker"},A={ODB:!r.n},L={ODC:"UseNewShareDialogForWinApp"},k=(r.n,r.t,{ODC:"UseVroomInItemsScopeAllPhotos"}),M={ODC:"UpdateOdcPhotoApiForConvergence"},P=(r.t,{ODC:"NPSCampaignDogfood"}),T={ODC:"NPSCampaignForceNomination"},U={ODC:"NPSSuiteSurvey"},F={ODC:"AllPhotosFpsCampaign"},H={ODB:60101,ODC:"FPSMoveCopy"},R={ODC:"NLQSSurvey"};i.e.isActivated("a22e84e5-8586-40bd-8095-9c90ab3fad2b","12/08/2020","Use the new tile design in the more shared libraries page"),i.e.isActivated("a393b488-dba6-431f-b6f9-383f65f2340b","4/10/2023","Protection for sensitivity label changes that are not blocked by doclib flight."),i.e.isActivated("a66557cf-0022-43dd-b951-e1b1fa3fcad4","04/07/2023","allow OneUpLightSpeed to override selection"),__WRAPPED_get(window,'location').href.toString().indexOf("detailsPane"),i.e.isActivated("74355188-3458-42A4-9DB6-5666BA79B5EB","03/02/2022","Moves transition resources to the KnockoutResourceScope as a preparation for OnDemand Knockout"),i.e.isActivated("641e3add-dd2f-41f8-b6f7-fc34cf2c3e43","10/06/2023","Disable Clipchamp in New Button and Edit New Button Section in SP Sites"),r.t,i.e.isActivated("f8821413-7078-41bf-b2f4-f23a04fb160a","05/11/2021","Log error in PrefetchListData method"),i.e.isActivated("FF1B4420-96EA-4BE2-9DD2-250D0CAFB79E","04/10/2023","Use base OneDrive nav in File Browser"),i.e.isActivated("CC7D2937-5E6E-4604-AAC5-E5A8DD34BFFB","11/08/2022","Flush telemetry before notifying Picker host");var N={Fallback:!i.e.isActivated("2A89B57A-0069-4F50-AAD5-3B931C8EF512","03/08/2023","Enable open on drag-hover")},B={Fallback:!i.e.isActivated("00783027-B2E9-4B88-82FB-C2921BF253B2","03/18/2023","Enable Drag/Drop copy")},j=(i.e.isActivated("63B21C89-2740-44A9-980B-DDA8E2689DAA","07/21/2021","Do not invalidate source location when performing a copy"),i.e.isActivated("63B21C89-2740-44A9-980B-DDA8E2689DAA","07/21/2021","Do not invalidate source location when performing a copy"),i.e.isActivated("60FAB98B-2A5D-4153-B69A-46A9C7C4B6D7","11/17/2021","Use SelectionHelper to get the current item"),i.e.isActivated("CCA9C934-1E36-4308-B93D-0025EAAECC37","11/17/2021","Use SelectionHelper to get the current item in AddToAlbumExecutor"),i.e.isActivated("EB5778E9-2AB1-4A93-AED8-64615D06F8D6","03/01/2022","Show notification banner in Lightspeed"),{ODB:60674}),V=function(e){if(i.e.isActivated("ff60da5f-a9ea-432e-9d7b-d58b8f7519ba","2/19/2021","ServiceConfigSettingKillSwitch"))return 1===Number(z(e));if(i.e.isActivated("23a54fe5-4472-4139-b74f-4b9e45901702","8/25/2023","Normalize service config boolean settings casing"))return 1===Number(z(e))||"true"===z(e);var t=z(e);return!!t&&(1===Number(t)||"true"===t.toLowerCase());},z=(i.e.isActivated("74216f8a-f424-4b58-9d69-5fcbd587c0d2","05/30/2023","Enable telemetry for enhanced image tagging library toggle actions"),function(e){if(r.r&&r.r.farmSettings)return __WRAPPED_get(r.r.farmSettings,e);}),G=function(e){return e.serviceSetting?V(e.serviceSetting):a.n.isFeatureEnabled(e);},K=r.n?function(e){return!!Object(r.i)()&&G(e===L?e={ODC:"UseNewShareDialogForWinApp"}:e);}:G,W={ODB:1652};i.e.isActivated("3B74ED7B-F809-4BB0-9679-6542982D256C","06/23/2023","Switch to use of ODCInit for 1DS"),i.e.isActivated("0c7daee7-fce1-4cf2-bb94-988d168bb456","09/01/2023","Enable fix for image tagger toggle text rendering");},531:function(e,t,n){"use strict";n.d(t,"r",function(){return i;}),n.d(t,"n",function(){return r;}),n.d(t,"a",function(){return o;}),n.d(t,"t",function(){return s;}),n.d(t,"e",function(){return c;}),n.d(t,"i",function(){return d;});var a=n(3);n(280);var i=window._spPageContextInfo,r=(function(){var e=-1!==navigator.userAgent.indexOf("OneDriveWinApp");try{e=e||!!window.sessionStorage.getItem("_isOneDriveWinApp");}catch(e){}return e;}()),o=window._spModuleLink&&"SPListWebPack"===window._spModuleLink.manifestName,s=!i||"21"===i.webTemplate&&700===i.listBaseTemplate,c=(window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,a.e.isActivated("E1435EAC-8118-427E-B25A-948FEA73E32A","6/6/2023","Use ODBInit for main thread instead of initializeOneDSTelemetry"),a.e.isActivated("31D882E5-E207-4736-8B8E-DF0970630CE7","4/24/2023","Disable select-field data scrubbing in 1DS."),{Fallback:!a.e.isActivated("B35E04AA-346B-44E3-B7A4-88FC1D79C889","01/06/2023","Enable Popup flow for MSAL authentication")}),d=(a.e.isActivated("DC975CAD-8F3C-4979-97E2-DA9970A68919","03/25/2022","Prefer isMySiteOwner check for ODB"),function(){var e=(function(){if((function(){try{return!!window.sessionStorage.getItem("_isOneDriveWinApp");}catch(e){return!1;}}()))return{winappMajorVersion:100,winappMinorVersion:0,winappPatchVersion:0};var e=navigator.userAgent,t=e.substring(e.indexOf("OneDriveWinApp")),n=t&&t.split("/"),a=r&&(n.length>1?n[1].split("."):t);return{winappMajorVersion:a?parseInt(a[0],10):"-1",winappMinorVersion:a?parseInt(a[1],10):"-1",winappPatchVersion:a?parseInt(a[2],10):"-1"};}()),t=e.winappMajorVersion,n=e.winappMinorVersion,a=e.winappPatchVersion;return!(t<19||19===t&&(n<23||23===n&&a<7));});},538:function(e,t,n){"use strict";var a=n(3);t.e=a.e;},539:function(e,t,n){"use strict";n.d(t,"t",function(){return i.e;}),n.d(t,"e",function(){return r;});var a=n(11),i=n(41),r=(new a.t("sharingContextInformation"),new a.t("listContext"));new a.t("listItems"),new a.t("inplaceEditorUrl"),new a.t("inplaceEditorClosing"),new a.t("appViewChangeInProgress"),new a.t("appViewChangeInProgress"),new a.t("itemsPerGroup"),new a.t("loggingContext"),new a.t("loggingContextBuckets"),new a.t("provider.contentTypes"),new a.t("onePageContext"),new a.t("searchBehavior"),new a.t("newDocumentTemplates"),new a.t("listsHostContext"),new a.t("listsHostWelcomeContext"),new a.t("getApplicationKey");},543:function(e,t,n){"use strict";n.d(t,"y",function(){return o;}),n.d(t,"v",function(){return s;}),n.d(t,"l",function(){return c;}),n.d(t,"h",function(){return d;}),n.d(t,"b",function(){return l;}),n.d(t,"_",function(){return u;}),n.d(t,"i",function(){return f;}),n.d(t,"m",function(){return p;}),n.d(t,"f",function(){return m;}),n.d(t,"u",function(){return _;}),n.d(t,"p",function(){return h;}),n.d(t,"S",function(){return b;}),n.d(t,"O",function(){return g;}),n.d(t,"c",function(){return v;}),n.d(t,"n",function(){return y;}),n.d(t,"a",function(){return S;}),n.d(t,"o",function(){return D;}),n.d(t,"s",function(){return I;}),n.d(t,"t",function(){return x;}),n.d(t,"r",function(){return C;}),n.d(t,"d",function(){return O;}),n.d(t,"L",function(){return w;});var a=n(538),i=n(528);n.d(t,"e",function(){return i.a;}),n.d(t,"g",function(){return i.p;}),n.d(t,"D",function(){return i.h;}),n.d(t,"I",function(){return i.b;}),n.d(t,"x",function(){return i.g;}),n.d(t,"C",function(){return i.v;}),n.d(t,"w",function(){return i.k;}),n.d(t,"E",function(){return i.M;}),n.d(t,"A",function(){return i.T;}),n(544);var r=window._spPageContextInfo,o={Fallback:!0},s={},c={ODB:833,ODC:!0},d=(i.U,{ODC:"EnableAtMentionTeachingUIAA"}),l={ODC:"EnableAtMentionTeachingUIAB"},u={ODC:"EnableAtMentionTeachingUI"},f=(i.U||r.listBaseTemplate,a.e.isActivated("63D3DE85-2D59-4622-8BD4-CEEC395F89D6","10/21/2021","Enable anonymous report concern command"),{ODC:"EnableEnhancedMobileUpsell"}),p=(a.e.isActivated("b8c885e0-1292-4bba-a624-d365f85bf140","05/27/2021","Show the new create shared library UI in ODB"),a.e.isActivated("5b1beb70-aac8-4da3-a4e2-151c7e55cd53","Fallback to global canManageLinks logic"),{ODB:620}),m={ODB:1142},_={ODB:1052},h={ODB:1227},b={ODC:"ReadOnlyItemsStore",ODB:-17},g={ODB:1417},v=(a.e.isActivated("61c45046-bce1-4f47-a4dc-477520ba1895","11/16/2021","Do not invalidate item after sharing when in search view"),a.e.isActivated("cce0d731-4a47-460e-b5d5-c31fdf4d347a","9/11/2020","Pass through clientId to hosted OneUp WAC app"),a.e.isActivated("53c310fe-1add-42fe-9e42-26b35764ed1a","12/14/2020","Pass through docClickTime to hosted OneUp WAC app"),a.e.isActivated("bcc0651f-a0de-430b-8435-1afc9875b682","08/03/2021","Pass through uih to hosted OneUp WAC app"),a.e.isActivated("731D9A2D-7DDD-4DE8-98D1-D454F59246E7","05/30/2022","Pass through EmbeddingPageSessionInfo and EmbeddingPageOrigin to hosted OneUp WAC app"),{ODB:826,OneDrive:!0}),y=(a.e.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),a.e.isActivated("f50a33e2-f57e-4b97-a36d-d6a3be9e5240","02/09/2021","Add forced new token while trying to get token"),a.e.isActivated("97048ac2-781a-4ee8-8f5d-46995f622c82","05/24/2021","Use GraphDatasource to get and refresh driveAccessToken"),a.e.isActivated("d6cee8cb-7162-4dee-a43b-63adeeb1971d","01/27/2021","Sets a query param (correlationId) which can help debug client errors using service logs"),a.e.isActivated("eae1b7c5-a0b3-43b0-839c-30cfbc2e5a9d","4/12/2021","Add sending of playbackSessionId and content category as qsp"),a.e.isActivated("276f3e59-6a18-4296-b221-d9fbe60eca97","2/9/2021","Use a window.fetch  request to check for cors errors"),a.e.isActivated("71913f76-47d4-4293-a492-2205b7c1e655","3/18/2021","Enable sending of heartbeat telemetry"),a.e.isActivated("bdfc077e-7152-4772-874e-1936725cde1f","3/24/2021","Enable max retries check on RequestManager in Dashling."),a.e.isActivated("9d46a6f9-9676-41ed-a4b5-3c01c1080993","3/1/2021","Use the height specified in the adaptation set as the resolution, rather than parsing it from the resolutionId"),a.e.isActivated("d4be6831-a0f7-40f7-b77b-5ad215b528c9","8/19/2020","Control if video dashling telemetry is enabled"),a.e.isActivated("20f62141-0df7-4eb3-943c-ff45219c1ee1","8/19/2020","Control if video dashling decryptor v2 is disabled"),a.e.isActivated("f6b9287b-5835-460b-8651-ae3b92ec34ce","9/14/2020","Control if video dashling supports parallel key call"),a.e.isActivated("336583dd-00a6-40dd-beea-2f2068fb2f0c","8/19/2020","Control if video dashling cdn ref ids telemetry is enabled"),a.e.isActivated("c56be611-10e0-4cde-8a46-1244a42f47b3","9/28/2020","Control if video dashling telemetry info is enabled"),a.e.isActivated("b8133a0d-36a6-4a4d-ba26-fb4563484d41","11/11/2020","Control if video refresh token is enabled"),a.e.isActivated("22f8bf4b-d19c-4c1f-a5a7-cb2fd36c8d6c","10/05/2020","Control if force Meta params are enabled"),a.e.isActivated("351ee0af-7950-49cf-a8f7-2fa77e44fb97","11/05/2020","Control if smart playback is enabled"),a.e.isActivated("45a43ec1-f520-41e6-9f94-4d14af7ccf6d","9/30/2020","Control if video dashling optimizations are enabled"),a.e.isActivated("411555f8-233c-4f56-97f4-586835b5e130","04/03/2021","Retry video metadata call with the access token provided in the playback URLs"),a.e.isActivated("cc74fd4e-2d38-4443-a603-78c3c5024447","09/01/2020","Call MeTa to verify captions exist before showing UI toggle"),a.e.isActivated("c1063c7b-5a82-4f68-84ca-3920d6541988","2/11/2021","Controls teams meeting recordings fallback to ffmpeg when media foundation unsuccessful"),a.e.isActivated("bf4f93e0-a68d-4655-aafa-234b12eeceef","5/12/2023","Change client id for share in Stream view experience"),a.e.isActivated("0f853474-6c72-4456-ac06-ed2da32c4d44","3/9/2021","Identify OneUpPlayer to MeTA transcode service"),a.e.isActivated("174C413E-7F06-49B2-AFBE-D1C3E6972EBA","11/24/2021","Disable SK compliance video block for ODC"),a.e.isActivated("dbecc8cc-2bf6-4a33-bedf-9f71faa71fdf","1/5/2021","Controls DASH playback on Safari"),a.e.isActivated("ce53700c-4498-49ef-b738-21131fdc2551","5/30/2021","Enable pretranscode support"),a.e.isActivated("398DDB43-D6A8-4060-8F69-378A0AEF845A","03/25/2022","Display request access button when no permission (403)"),a.e.isActivated("d047b4a4-477a-4da6-b18c-1eb7daf19cc8","11/03/2021","Add request access button to OneUp curtain"),a.e.isActivated("0b6f3eb5-90ef-4e77-81d9-2286c06c3257","07/20/2021","Engagement Telemetry Enhancement for 1up according to ask from OnePlayer"),a.e.isActivated("ca5833b4-d7d9-406d-8e36-fc28548b52a2","10/21/2020","Update video autoplay behavior"),{ODC:"EnableEditControlTeachingBubble"}),S={ODB:!a.e.isActivated("9ffb3b8b-fbfe-4c66-bd3a-34f3451d6037","02/06/2023","Killswitch to enable teaching bubble for PDF editing")},D={ODB:!a.e.isActivated("ecae7a95-d6a0-4940-a5dc-236ef7ab6f55","02/06/2023","Killswitch to enable teaching bubble for PDF extract and merge")},I={ODB:!a.e.isActivated("66097d38-1f87-4a2d-983d-89a2ed26b2d8","12/06/2023","Killswitch to enable teaching bubble for PDF get eSignatures")},x={ODB:!a.e.isActivated("260364a3-3855-4555-95ad-fc012bfe8d0c","01/06/2022","Enable ER Bug fixes for Universal Annotations"),ODC:!1,OneDrive:!1,Fallback:!1},C=(a.e.isActivated("bd34a99e-6762-42ac-9795-c2123340281b","11/17/2021","Enable FFMPEG transcoding for all HLS sessions"),a.e.isActivated("ac5fc96a-ba27-41c2-8211-39a2d12bd2b0","2/17/2022","When the browser is Safari, force the video files to play using native player"),a.e.isActivated("1ba50e39-1615-4340-82c7-765408f11243","4/27/2022","When progressive playback is used, add cross origin anonymous to the video element"),{ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1}),O=(a.e.isActivated("F6679A55-17E3-4F3B-BECF-7B969EB307C2","02/08/2022","Check if the teams meeting recording has an expiration date."),a.e.isActivated("0c7f0abb-bacf-45f2-814d-61bb1e84f2f5","8/1/2021","move target up to solve keybinding issues"),a.e.isActivated("884acaf3-037b-4c3a-b169-eddffd004e69","06/20/2023","Enables fix for items scope hierarchy to be able to use the useAction hook properly"),a.e.isActivated("2a642dc2-93e1-41f8-b6e1-d7c4c9acecd2","09/08/2022","View button for opening uploaded video in SWA in new tab"),a.e.isActivated("3cf3efe2-3050-4c01-8597-317ed1e0acc2","28/08/2022","Open button for opening moved/copied video in SWA in new tab"),a.e.isActivated("b2895e2b-5ca4-448b-955c-38d728d7e7b2","23/12/2022","Do not show links in SWA upload popup and panel for destination directories"),a.e.isActivated("4678edfd-5753-410d-a418-5ce8e9368075","10/03/2022","Refactoring code for open button showing after moved/copied video in SWA"),a.e.isActivated("f2e15bcb-b2af-40ee-90fa-4d0e27ac3b99","09/13/2022","Opening Video Settings automatically after opening uploaded video"),a.e.isActivated("461e4739-e857-4d71-88da-805c7c90b75e","10/06/2022","Having only one item in new menu dropdown if other is turned off"),a.e.isActivated("D095D1B3-A17F-441B-8855-D465ED3CA91F","12/15/2021",""),a.e.isActivated("25B37479-0FDE-4A4C-B58F-3FD5F9A152BA","05/10/2023","Create ODF document with VROOM FOR COB users"),{ODB:!a.e.isActivated("483a92b4-201c-4b8c-b657-3fe2ce288672","4/22/2022","Show teaching bubble for TMR files consistently before user closes it."),ODC:!1,OneDrive:!1,Fallback:!1}),w=(a.e.isActivated("a6183b15-1c4c-4fe0-b52c-b263235d6c3d","5/11/2022","Use UTC time zone for TMR"),a.e.isActivated("744d1129-5df2-4930-b056-7bc0fb82151b","5/11/2022","Feature to check if video codec is in the list of unsupported by browser"),a.e.isActivated("DE2FA0D9-D704-4B85-916B-9DB19121E9A1","3/21/2023","Fix COB OneUp cannot open thumbnail correctly."),a.e.isActivated("b2ac1c0f-d8e1-4f24-9d57-41afa45a5f66","10/11/2022","Killswitch to enable prefetching video with low bitrate"),a.e.isActivated("25c1f6db-47d7-4e6b-b85e-80d4815265b1","9/29/2022","Killswitch to add error handling for getrequestparametersasync call in prefetch"),a.e.isActivated("60fdf489-9918-46ee-8151-5a98bc049a81","10/26/2022","Killswitch to add logging for error in fetch operation"),{ODB:1347});a.e.isActivated("51ee2bb9-9d53-45e8-a198-02a1d377f01d","1/23/2023","Remove tooltip from new button on command bar"),a.e.isActivated("ea1dd803-26eb-41a5-bb51-04e08a8930b6","8/31/2023","Remove KO view param from PlayBackHelper as it can be obtained from navigation directly"),a.e.isActivated("821989C8-65C4-4430-8FD9-6B1F23BBCBBE","07/19/2023","Fix the issue that missing customization option for Excel files in embed dialog."),a.e.isActivated("912acc33-b0b5-4ff1-88cf-a898791ccda0","08/04/2023","Enables fix for items scope hierarchy to be able to use the us actions with global scope"),a.e.isActivated("9EED27A7-3B37-4C60-AD36-B0B1D12A46B9","08/01/2023","Generate the ConfiguratorUrl of excel files for converged consumers.");},544:function(e,t,n){"use strict";n.d(t,"e",function(){return a;});var a={ODB:!n(3).e.isActivated("96723D41-0476-4E60-A02D-199517143E81","11/10/2020","Allow ADAL as fallback for OAuth token requests")};},637:function(e,t,n){"use strict";n.d(t,"e",function(){return a;});var a=new(n(11)).t("KnockoutResourceScope.key");},664:function(e,t,n){"use strict";n.d(t,"e",function(){return i;});var a=n(195);function i(e,t){if(void 0===t&&(t=0),!e.expiry){var n=(function(e){return Object(a.n)(e);}(e.authToken));e.expiry=n&&(function(e){try{return new Date(parseInt(e+"000",10));}catch(e){}}(n.exp));}return(e.expiry?e.expiry.getTime():0)-Date.now()<t;}},683:function(e,t,n){"use strict";n.d(t,"e",function(){return u;});var a=n(0),i=n(62),r=n(11),o=n(93),s=n(539),c=new r.t({name:"KnockoutAuthTokenDataSource.key",loader:new o.t(function(){return n.ee([40,"odsp.knockout.lib","ondemand.resx-ondemand"],858).then(function(e){return e.resourceKey;});})}),d=n(637),l=(function(){function e(e,t){void 0===e&&(e={}),this._asyncKnockoutAuthTokenDataSource=t.asyncKnockoutAuthTokenDataSource,this._pageContext=t.pageContext,this._resources=t.resources;}return e.prototype.getAuthToken=function(e){return Object(a.t)(this,void 0,i.t,function(){var t,n,r;return Object(a.i)(this,function(a){switch(a.label){case 0:return this._pageContext.isSPO?[4,this._resources.consumeAsync(d.e.optional)]:[2,Promise.reject(new Error("getAuthToken is not supported OnPrem"))];case 1:return a.sent(),[4,this._asyncKnockoutAuthTokenDataSource()];case 2:return t=a.sent(),r=(n=i.t).wrap,[4,t.getAuthToken(e)];case 3:return[2,r.apply(n,[a.sent()])];}});});},e.dependencies={asyncKnockoutAuthTokenDataSource:c.async,pageContext:s.t,resources:r.i},e;}()),u=Object(o.r)("AsyncKnockoutAuthTokenDataSource",l);},749:function(e,t,n){"use strict";n.r(t),n.d(t,"typeResourceKey",function(){return Te;}),n.d(t,"resourceKey",function(){return Ue;});var a,i,r,o=n(0),s=n(93),c=n(11),d=n(476),l=n(53),u=n(97),f={accdb:{extensions:["accdb","mdb"]},archive:{type:u.e.Unknown,extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{type:u.e.Unknown,extensions:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"]},clipchamp:{extensions:["clipchamp"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},css:{},csv:{extensions:["csv"]},docset:{type:u.e.Folder,iconType:"svg"},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{type:u.e.Unknown,extensions:["eml","msg","ost","pst"]},exe:{type:u.e.Unknown,extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},loop:{extensions:["fluid","loop"]},folder:{type:u.e.Folder,iconType:"svg"},form:{extensions:["form"]},font:{type:u.e.Unknown,extensions:["ttf","otf","woff"]},genericfile:{type:u.e.Unknown},html:{extensions:["htm","html","mht"]},link:{type:u.e.Unknown,extensions:["lnk","link","url","website","webloc"]},splist:{type:u.e.Unknown,extensions:["listitem"]},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},one:{type:u.e.OneNote,extensions:["note","one"]},onetoc:{type:u.e.OneNote,extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pdf:{extensions:["pdf"]},powerbi:{extensions:["pbix"]},photo:{type:u.e.Media,extensions:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"]},photo360:{},potx:{extensions:["pot","potm","potx"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx"]},sponews:{},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{type:u.e.Folder,iconType:"svg"},linkedfolder:{type:u.e.Shortcut,iconType:"svg"},spreadsheet:{extensions:["ods","gsheet","numbers"]},sysfile:{type:u.e.Unknown,extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vector:{type:u.e.Unknown,extensions:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{type:u.e.Media,extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mp4v","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vsd","vsdm","vsdx","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx"]},xlsx:{extensions:["xls","xlsb","xlsm","xlsx"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{type:u.e.Unknown,extensions:["zip"]}};!(function(e){__WRAPPED_set(e,e.Invalid=0,'=',"Invalid"),__WRAPPED_set(e,e.File=1,'=',"File"),__WRAPPED_set(e,e.FileVersion=2,'=',"FileVersion"),__WRAPPED_set(e,e.ListItem=3,'=',"ListItem"),__WRAPPED_set(e,e.List=4,'=',"List"),__WRAPPED_set(e,e.Folder=5,'=',"Folder"),__WRAPPED_set(e,e.FolderWithLists=6,'=',"FolderWithLists"),__WRAPPED_set(e,e.Attachment=7,'=',"Attachment"),__WRAPPED_set(e,e.ListItemVersion=8,'=',"ListItemVersion"),__WRAPPED_set(e,e.CascadeParent=9,'=',"CascadeParent"),__WRAPPED_set(e,e.Web=10,'=',"Web"),__WRAPPED_set(e,e.App=11,'=',"App");}(a||(a={}))),(function(e){__WRAPPED_set(e,e.Public=0,'=',"Public"),__WRAPPED_set(e,e.PublicUnlisted=2,'=',"PublicUnlisted"),__WRAPPED_set(e,e.Shared=3,'=',"Shared"),__WRAPPED_set(e,e.Private=4,'=',"Private"),__WRAPPED_set(e,e.Unknown=5,'=',"Unknown");}(i||(i={})));var p,m=n(16),_=["cool","fbx","obj","ply","stl","3mf"],h="{.mediaBaseUrl}/transform/zip?cs={.callerStack}";!(function(e){e.accessToken=".accessToken",e.callerStack=".callerStack",e.correlationId=".correlationId",e.mediaBaseUrl=".mediaBaseUrl",e.mediaBaseUrlSecondary=".mediaBaseUrlSecondary",e.pushChannelBaseUrl=".pushChannelBaseUrl",e.driveAccessToken=".driveAccessToken",e.driveAccessTokenV21=".driveAccessTokenV21",e.driveUrl=".driveUrl",e.driveUrlV21=".driveUrlV21",e.pdfConversionUrl=".pdfConversionUrl",e.thumbnailUrl=".thumbnailUrl",e.transformUrl=".transformUrl",e.videoManifestUrl=".videoManifestUrl",e.zipUrl=".zipUrl",e.officeBundleGenerate=".officeBundleGenerate",e.officeBundleGetFragment=".officeBundleGetFragment",e.resourceUrl=".spResourceUrl",e.fileType=".fileType",e.itemUrl=".spItemUrl",e.cTag=".ctag",e.hasBxf=".hasBxf",e.hasOfficePreview=".hasOfficePreview",e.hasPdf=".hasPdf",e.hasThumbnail=".hasThumbnail",e.hasVideoManifest=".hasVideoManifest",e.analyzeUrl=".analyzeUrl";}(p||(p={})));var b=[p.accessToken,p.callerStack,p.mediaBaseUrl,p.mediaBaseUrlSecondary,p.pushChannelBaseUrl,p.driveAccessToken,p.driveUrl,p.driveAccessTokenV21,p.driveUrlV21,p.zipUrl,p.pdfConversionUrl,p.thumbnailUrl,p.transformUrl,p.videoManifestUrl,p.officeBundleGenerate,p.officeBundleGetFragment],g=[p.callerStack,p.correlationId,p.mediaBaseUrl,p.resourceUrl],v=["ai","pdf"],y=["doc","docx","odt","rtf","ods","xls","xlsm","xlsx","odp","ppt","pptx","pps","ppsx","tiff","tif","epub","htm","html","eml","msg","md","markdown"],S=["dwg","dxf"];function D(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0;}var I=n(170),x={ODB:620};function C(e,t){return"https://media.cloudapp.net"===e?"edog"===t?"https://centralus1-mediad.svc.ms":"https://northcentralus1-medias.svc.ms":e;}function O(e,t,n,a){return e.replace(/{([^\}]*)}/g,function(e,i){if(i in n){var r=__WRAPPED_get(n,i);if(void 0===r)throw new Error(" URI template contains recursion on variable ".concat(i));return r;}var o=__WRAPPED_get(t,i);if(void 0===o)throw new Error("URI template contains unknown variable ".concat(i));if(i===p.itemUrl||i===p.resourceUrl){if((function(e,t){if(t)return!1;var n=e.indexOf("/",8);return e.substring(n).length>215;}(o,a)))throw new Error("URI template variable ".concat(i," is too long: ").concat(o));return __WRAPPED_set(n,i,'=',encodeURIComponent(o));}return __WRAPPED_set(n,i,'=',void 0),__WRAPPED_set(n,i,'=',O(o,t,n,a));});}function w(e,t,n,a,i,r){var s,c,d=Object(o.e)(Object(o.e)(Object(o.e)(Object(o.e)({},e),"string"==typeof a?{".method":a}:{}),t===p.zipUrl?(__WRAPPED_set(s={},p.fileType,'=',"zipfile"),s):{}),n||{}),l=__WRAPPED_get(d,t);if(l)try{var u=O(l,d,(__WRAPPED_set(c={},t,'=',void 0),c),!!r);return i?"".concat(u,"&nocache=true"):u;}catch(e){return;}}var E=n(3).t.isActivated("79c1df67-19f8-4729-b45e-cbdfa58d1041","07/27/2021","Add cTag for item url to update the cache for the item content"),A=(function(){function e(e,t){this._properties={},this._authData=void 0,this._allowCookies=!t.platformDetection.isSafari;var n=t.pageContext,a=n.env,i=n.userEmail,r=n.viewOnlyExperienceEnabled;this._env=a,this._isViewOnly=!!r,this._userID=i;}return e.prototype.getCommonAuthData=function(){return this._authData;},e.prototype.getCommonProperty=function(e){return __WRAPPED_get(this._properties,e);},e.prototype.parseCommonData=function(e){return(function(e,t,n){__WRAPPED_set(e,p.zipUrl,'=',h);for(var a=0,i=b;a<i.length;a++){var r=__WRAPPED_get(i,a);__WRAPPED_get(t,r)&&__WRAPPED_set(e,r,'=',__WRAPPED_get(t,r));}__WRAPPED_set(e,p.mediaBaseUrl,'=',C(__WRAPPED_get(e,p.mediaBaseUrl),n)),__WRAPPED_set(e,p.mediaBaseUrlSecondary,'=',C(__WRAPPED_get(e,p.mediaBaseUrlSecondary),n));}(this._properties,e.data,this._env)),this._authData=this._getCurrentAuthData(e.allowCookies&&this._allowCookies),{authData:this._authData,mediaUrl:__WRAPPED_get(this._properties,p.mediaBaseUrl)};},e.prototype.getUniqueKey=function(){var e=__WRAPPED_get(this._properties,p.driveUrl)||__WRAPPED_get(this._properties,p.driveUrlV21),t=this._userID;return t&&e?"".concat(t,"-").concat(e):"";},e.prototype.generateUrl=function(e,t,n){var a=this.getNormalUrl(e,t,n)||this.getFallbackUrl(e,t,n),i=__WRAPPED_get(t,p.cTag);return!E&&i&&a&&a.indexOf("?")>-1&&(a+="&cTag=".concat(encodeURIComponent(i))),a;},e.prototype.getAnalyzeUrl=function(e,t){return w(Object(o.e)({".analyzeUrl":"{.mediaBaseUrl}/analyze?provider=spo&profile=".concat(e,"&extension={.fileType}&docid={.spItemUrl}&{.driveAccessToken").concat(m.n.isFeatureEnabled(x)?"V21":"","}")},this._properties),p.analyzeUrl,t);},e.prototype.getNormalUrl=function(e,t,n){return w(this._properties,e,t,n,this._isViewOnly,this._authData&&this._authData.supportsCookies);},e.prototype.getFallbackUrl=function(e,t,n){var a=__WRAPPED_get(t,e);if(a){a=a.replace("{.method}",n);for(var i=0,r=g;i<r.length;i++){var o=__WRAPPED_get(r,i),s=__WRAPPED_get(t,o);if(o===p.mediaBaseUrl&&(s=C(s,this._env)),!s){if(o===p.correlationId){a=a.replace("&correlationId={.correlationId}","");continue;}return;}o===p.resourceUrl&&(s=encodeURIComponent(s)),a=a.replace("{".concat(o,"}"),s);}return this._isViewOnly&&(a+="&nocache=true"),a;}},e.prototype._getCurrentAuthData=function(e){var t=L(__WRAPPED_get(this._properties,p.driveAccessToken)),n=L(__WRAPPED_get(this._properties,p.driveAccessTokenV21));if(n&&t){var a=new Date();return{authToken:t.authToken,proofToken:t.proofToken,tokenUrl:__WRAPPED_get(this._properties,p.driveUrl),authTokenV21:n.authToken,proofTokenV21:n.proofToken,tokenUrlV21:__WRAPPED_get(this._properties,p.driveUrlV21),timeReceived:a,expirationTime:new Date(a.getTime()+216e5),supportsCookies:e};}},e;}());function L(e){if(e){var t=Object(I.e)(e);return t&&t.access_token?{authToken:t.access_token,proofToken:t.prooftoken}:void 0;}}var k=new Set();k.add(".docx"),k.add(".txt"),k.add(".html");var M,P={ODC:"EnableAudioPlayer",ODB:841,OneDrive:!0},T={"ar-SA":!0,"he-IL":!0,"ja-JP":!0,"ko-KR":!0,"zh-CN":!0},U=/&(?:access_|proof)token=[^&]*/g,F=(function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._baseInfoSetCallbacks=[],a._authDataSignalCompleted=!1,a._authDataSignal=new d.e(),a._authTokenDataSource=n.authTokenDataSource,a._baseInfoSet=!1,a;}return Object(o.a)(t,e),t.prototype.getAuthData=function(){var e=this;return this._authTokenDataSource&&this.hasAuthDataExpired()?this._authTokenDataSource.getAuthToken({}).then(function(t){return e.setBaseInfo(t),e._authDataSignal.getPromise();}):this._authDataSignal.getPromise();},t.prototype.hasAuthData=function(){return!!this._processor.getCommonAuthData();},t.prototype.hasAuthDataExpired=function(){var e=new Date();e.setMinutes(e.getMinutes()+5);var t=this._processor.getCommonAuthData();return!!t&&t.expirationTime<=e;},t.prototype.setBaseInfo=function(e){this._baseInfoSet=!0;var t=this._processor.parseCommonData(e);t.authData&&(this._authDataSignalCompleted?(this._authDataSignal=new d.e(),this._authDataSignal.complete(t.authData)):(this._authDataSignalCompleted=!0,this._authDataSignal.complete(t.authData))),this._cookieHelper.checkCookies(t.mediaUrl,t.authData);for(var n=0,a=this._baseInfoSetCallbacks;n<a.length;n++)(0,__WRAPPED_get(a,n))();},t.prototype.hasSetBaseInfo=function(){return this._baseInfoSet;},t.prototype.registerSetBaseInfoCallback=function(e){this._baseInfoSetCallbacks.push(e);},t;}((function(){function e(e,t){this._processor=t.metaDataProcessor,this._cookieHelper=t.authCookieHelper,this._thumbnailHelper=t.thumbnailHelper,this._pageContext=t.pageContext,this._authTokenStore=t.authTokenStore;}return e.prototype.getVideoUrl=function(e){if("False"!==__WRAPPED_get(e.item,p.hasVideoManifest)||__WRAPPED_get(e.item,p.videoManifestUrl)||"audio"===(function(e){if(!r)for(var t in(r={},f)){var n=__WRAPPED_get(f,t).extensions;if(n)for(var a=0;a<n.length;a++)__WRAPPED_set(r,__WRAPPED_get(n,a),'=',t);}return e=e.replace(".","").toLowerCase(),__WRAPPED_get(r,e)||"genericfile";}(e.fileExtension))||m.n.isFeatureEnabled(P)){var t=this._processor.generateUrl(p.videoManifestUrl,e.item);if(t){if(E){var n=__WRAPPED_get(e.item,p.cTag);n&&(t+="&cTag=".concat(encodeURIComponent(n)));}t+="&action=Access";}return t;}},e.prototype.getThumbnail=function(e){if(("False"!==__WRAPPED_get(e.item,p.hasThumbnail)||__WRAPPED_get(e.item,p.thumbnailUrl))&&this._thumbnailHelper.canProvideThumbnail(e.fileExtension)){var t=this._processor.generateUrl(p.thumbnailUrl,e.item);t&&(t+="&encodeFailures=1");var n=e.allowCookieAuth,a=void 0===n||n,i=e.itemKey,r=e.fileExtension,o=e.mediaServiceMetadata;if(t&&a&&this._cookieHelper.canUseCookies())t=t.replace(U,""),E&&__WRAPPED_get(e.item,p.cTag)&&(t+="&ctag="+encodeURIComponent(__WRAPPED_get(e.item,p.cTag))),this._cookieHelper.trackItem({itemKey:i,thumbnailUrl:t,fileExtension:r,mediaServiceMetadata:o});else if(t){var s=this._processor.getCommonAuthData();if(s){var c=m.n.isFeatureEnabled(x),d={authToken:c?s.authTokenV21:s.authToken,proofToken:c?s.proofTokenV21:s.proofToken},l=this._authTokenStore.getToken(this._processor.getUniqueKey(),d);l&&l!==d&&(t=t.replace(U,"&access_token=".concat(l.authToken).concat(l.proofToken?"&prooftoken=".concat(l.proofToken):"")));}}return t?this._thumbnailHelper.getThumbnail({itemKey:i,fileExtension:r,baseUrl:t,mediaServiceMetadata:o}):void 0;}},e.prototype.getDownloadAsZipUrl=function(e){var t=p.zipUrl,n=this._processor.getNormalUrl(t,e);return n||(__WRAPPED_set(e,p.zipUrl,'=',h),n=this._processor.getFallbackUrl(t,e)),n;},e.prototype.getPassthroughUrl=function(e){return this._processor.generateUrl(p.transformUrl,e.item,"passthrough");},e.prototype.getPdfConversionUrl=function(e,t){var n,a=e.fileExtension;return(this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled)&&D(v,a)?this.getPassthroughUrl(e):__WRAPPED_get(T,l.e.language)?void 0:D(y,n=a)||D(S,n)||t?this._processor.generateUrl(p.pdfConversionUrl,e.item):void 0;},e.prototype.getFbxConversionUrl=function(e){var t;return"True"===__WRAPPED_get(e.item,p.hasBxf)&&(t=e.fileExtension,(function(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0;}(_,t)))?this._processor.generateUrl(p.transformUrl,e.item,"bxf"):"";},e.prototype.getHtmlConversionUrl=function(e){return this._processor.generateUrl(p.transformUrl,e.item,"html");},e.prototype.getZipMetaDataUrl=function(e){return this._processor.generateUrl(p.transformUrl,e.item,"zipmetadata");},e.prototype.getDownloadZipContentsUrl=function(e){return this._processor.generateUrl(p.transformUrl,e,"zipcontent");},e.prototype.getImmersiveReaderUrl=function(e){var t;if(t=e.fileExtension,k.has(t))return this._processor.generateUrl(p.transformUrl,e.item,"imreader");},e.prototype.getOfficeBundleGenerateUrl=function(e){if("False"!==__WRAPPED_get(e.item,p.hasOfficePreview)||__WRAPPED_get(e.item,p.officeBundleGenerate)){var t=this._processor.generateUrl(p.officeBundleGenerate,e.item);if(E){var n=encodeURIComponent(__WRAPPED_get(e.item,p.cTag));return t&&t.replace("Generate","")+"&minVersion={{minVersion}}&cTag=".concat(n);}return t&&t.replace("Generate","")+"&minVersion={{minVersion}}";}},e.prototype.getOfficeBundleGetFragmentUrl=function(e){if("False"!==__WRAPPED_get(e.item,p.hasOfficePreview)||__WRAPPED_get(e.item,p.officeBundleGetFragment)){var t=this._processor.generateUrl(p.officeBundleGetFragment,e.item);return t&&t.replace("Get","")+"&fragment={0}";}},e.prototype.getitemUrlWithToken=function(e){var t=this._processor.getCommonProperty(p.driveAccessToken);return t&&(function(e,t){var n=e.toLowerCase();if(n.indexOf("access_token=")>-1||n.indexOf("tempauth=")>-1)return e;var a=-1===e.indexOf("?")?"?":"&";return"".concat(e).concat(a).concat(t.indexOf("access_token")>-1?t:"access_token=".concat(t));}(e,t));},e.prototype.getPushChannelUrl=function(){return this._processor.getCommonProperty(p.pushChannelBaseUrl);},e.prototype.getGenerateTranscriptUrl=function(e){return this._processor.getAnalyzeUrl("transcriptinit",e.item);},e.prototype.getMediaBaseUrl=function(e){return this._processor.generateUrl(p.mediaBaseUrl,e.item);},e;}()))),H=n(539),R=n(224),N=n(218),B=n(148),j=n(420),V=(function(){function e(e,t){void 0===e&&(e=new B.e()),void 0===t&&(t=1),this.translate=e,this.scale=t;}return e.areEqual=function(e,t,n){return void 0===n&&(n=1e-6),B.e.areEqual(e.translate,t.translate,n)&&Math.abs(Math.log(e.scale/t.scale))<n;},e.zoom=function(t,n,a){return new e(t.subtract(n).scale(a-1),a);},e.centerWithinBounds=function(t,n,a){return new e(new j.e(B.e.ORIGIN,t).getCenter().subtract(B.e.getCenter([n,a])));},e.prototype.apply=function(e){return e.scale(this.scale).add(this.translate);},e.prototype.multiply=function(t){return new e(this.translate.add(t.translate.scale(this.scale)),this.scale*t.scale);},e.prototype.invert=function(){return new e(this.translate.scale(-1/this.scale),1/this.scale);},e.prototype.toString=function(){return"[Transform (".concat(this.translate.x,", ").concat(this.translate.y,") ").concat(this.scale,"]");},e.IDENTITY=new e(),e;}()),z=V;!(function(e){__WRAPPED_set(e,e.cover=0,'=',"cover"),__WRAPPED_set(e,e.center=1,'=',"center"),__WRAPPED_set(e,e.fit=2,'=',"fit"),__WRAPPED_set(e,e.fitExpand=3,'=',"fitExpand"),__WRAPPED_set(e,e.fitExpandHeight=4,'=',"fitExpandHeight"),__WRAPPED_set(e,e.fitExpandWidth=5,'=',"fitExpandWidth"),__WRAPPED_set(e,e.fitWidth=6,'=',"fitWidth"),__WRAPPED_set(e,e.fitHeight=7,'=',"fitHeight"),__WRAPPED_set(e,e.top=8,'=',"top");}(M||(M={})));var G=function(e,t){this.name=e,this.getTransform=t;};function K(){for(var e=[],t=0;t<arguments.length;t++)__WRAPPED_set(e,t,'=',__WRAPPED_get(arguments,t));return new G(e.map(function(e){return e.name;}).join("-"),function(t,n){for(var a=z.IDENTITY,i=0,r=e;i<r.length;i++){var o=__WRAPPED_get(r,i),s={width:t.width*a.scale,height:t.height*a.scale};a=o.getTransform(s,n).multiply(a);}return a;});}var W=new G(__WRAPPED_get(M,M.center),function(e,t){var n=new B.e((t.width-e.width)/2,(t.height-e.height)/2);return new z(n);}),q=new G(__WRAPPED_get(M,M.top),function(e,t){var n=new B.e((t.width-e.width)/2,0);return new z(n);}),Q=new G(__WRAPPED_get(M,M.fitWidth),function(e,t){var n=t.width/e.width;return new z(B.e.ORIGIN,Math.min(n,1));}),Y=new G(__WRAPPED_get(M,M.fitHeight),function(e,t){var n=t.height/e.height;return new z(B.e.ORIGIN,Math.min(n,1));}),J=new G(__WRAPPED_get(M,M.fit),function(e,t){return(e.width/e.height>t.width/t.height?Q:Y).getTransform(e,t);}),X=new G(__WRAPPED_get(M,M.fitExpandWidth),function(e,t){var n=t.width/e.width;return new z(B.e.ORIGIN,n);}),Z=new G(__WRAPPED_get(M,M.fitExpandHeight),function(e,t){var n=t.height/e.height;return new z(B.e.ORIGIN,n);}),$=new G(__WRAPPED_get(M,M.fitExpand),function(e,t){return(e.width/e.height>t.width/t.height?X:Z).getTransform(e,t);}),ee=new G(__WRAPPED_get(M,M.cover),function(e,t){return(e.width/e.height>t.width/t.height?Y:Q).getTransform(e,t);}),te=(K(J,W),K($,W),K(ee,W)),ne=n(391),ae=n(18),ie={ODB:816,OneDrive:!0},re={ODB:820},oe={".xls":!0,".xlsx":!0},se={".jpg":!0,".jpeg":!0,".png":!0,".gif":!0,".doc":!0,".docx":!0,".ppt":!0,".pptx":!0},ce=(function(){function e(e,t){this._apiUrlHelper=t.apiUrlHelper;}return e.prototype.getImageUrl=function(e){if(e.isCrossDomain){var t=this._apiUrlHelper.build().webByItemUrl(e);return(t=(t=t.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:e.serverRelativeItemUrl})).segment("OpenBinaryStream")).toString();}return e.fullItemUrl;},e;}()),de=(function(){function e(e){this._itemUrlHelper=e.itemUrlHelper,this._crossDomainImageHelper=e.crossDomainImageHelper;}return e.prototype.getThumbnail=function(e){var t,n,a=this,i=e.fileExtension,r=void 0===i?"":i,s=e.itemKey,c=e.baseUrl,d=e.mediaServiceMetadata,l=d&&d.photo,u=d&&d.video;l?(t=l.width,n=l.height):u&&(t=u.frameWidth,n=u.frameHeight);var f={width:t||0,height:n||0};if(".gif"===r.toLowerCase()){var p=this._itemUrlHelper.getItemUrlParts(s),m=this._crossDomainImageHelper.getImageUrl(p),_=Object(o.e)({url:m},f);return Object(o.e)(Object(o.e)({},_),{getAligned:function(){return _;}});}if(c){var h=d&&d.lenses;return h&&h.officeLens&&(c+="&lenses=OfficeLens"),Object(o.e)(Object(o.e)({url:this._getUrl({baseUrl:c})},f),{getAligned:function(e,i){return Object(o.e)({url:a._getUrl({baseUrl:c,desiredSize:e,alignment:i,width:t,height:n})},f);}});}},e.prototype.canProvideThumbnail=function(e){return!(!e||("."===(e=e.toLowerCase())[0]&&(e=e.substring(1)),__WRAPPED_get(oe,e)||!ae.e.isFeatureEnabled(ie)&&(!ae.e.isFeatureEnabled(re)||!e||__WRAPPED_get(se,e))));},e.prototype._getUrl=function(e){var t,n=e.desiredSize,a=void 0===n?{width:1024,height:1024}:n,i=e.alignment,r=e.width,o=e.height;i&&(i.name===te.name?t="fill":i.name==="".concat(Q.name,"-").concat(q.name)&&(t="dochead"));var s={width:Math.ceil(a.width),height:Math.ceil(a.height),srcWidth:r||"",srcHeight:o||""};return t&&(s.cropMode=t),"".concat(e.baseUrl,"&").concat(Object(ne.e)(s));},e;}()),le={crossDomainImageHelper:Object(s.r)("".concat("ThumbnailHelper",".crossDomainImageHelper"),ce,{apiUrlHelper:R.e}),itemUrlHelper:N.r},ue=new c.t({name:"ThumbnailHelper",factory:{dependencies:le,create:function(e){var t=new de(e);return{instance:t,disposable:t};}}}),fe=n(259),pe=Object(s.r)("MetaDataProcessor",A,{pageContext:H.t,platformDetection:fe.e}),me=n(257),_e=n(62),he=n(305);function be(e){var t=new d.e(),n=document.createElement("img");return n.onload=function(){t.complete();},n.onerror=function(){t.error();},n.src=e,t.getPromise();}var ge,ve=[],ye=(function(){function e(e,t,n){this.complete=!1,this.pending=!1,this.eventName="cookieToss",this._lastAttempt=0,this.domainRegex=e,this.iframeSrc=t,this.complete=n;}return e.initializeAuthenticators=function(t,n){if(n)if(window.$Config.aadClientId&&"live.com"===window.$Config.domain);else{for(var a=n.s,i=n.r,r=0;a&&r<a.length;r++)ve.push(new e(__WRAPPED_get(t,r),__WRAPPED_get(a,r),!__WRAPPED_get(i,r)));n.c=function(e){__WRAPPED_get(ve,e).onAuthComplete();},e.authenticate("https://livefilestore.com/"),e.authenticate("https://1drv.com/");}},e.authenticate=function(e){for(var t,n=0;n<ve.length;n++){var a=__WRAPPED_get(ve,n);if(a.requiresAuth(e)){t=a.authenticate(e);break;}}for(var i=[t||_e.t.wrap(!0)],r=0,o=this._cookieCheckers;r<o.length;r++){var s=__WRAPPED_get(o,r);s.isApplicable(e)&&i.push(s.check(e));}return _e.t.all(i).then(function(e){return e.reduce(function(e,t){return e&&t;});});},e.registerCookieChecker=function(e){this._cookieCheckers.push(e);},e.prototype.requiresAuth=function(e){return this.domainRegex.test(e);},e.prototype.authenticate=function(e){var t=new Date().getTime();if(t-this._lastAttempt>6e5&&(this._authPromise=null,this._lastAttempt=t),!this._authPromise){this._authPromise=new d.e();var n=document.createElement("IFRAME");n.src=this.iframeSrc,n.style.display="none",document.body.appendChild(n);}return this._authPromise.getPromise();},e.prototype.onAuthComplete=function(){this._authPromise.complete(!0);},e._cookieCheckers=[],e;}());!(function(e){__WRAPPED_set(e,e.Failed=-1,'=',"Failed"),__WRAPPED_set(e,e.None=0,'=',"None"),__WRAPPED_set(e,e.Pending=1,'=',"Pending"),__WRAPPED_set(e,e.Success=2,'=',"Success");}(ge||(ge={})));var Se=(function(){function e(e,t){var n=this;this._platform=t.platformDetection,this.thumbnailHelper=t.thumbnailHelper,this._updateThumbnailUrlCallback=t.updateThumbnailUrlCallback,this._cookieState=ge.None,this._haveCookies=new d.e(),this.itemsWaitingForCookies=[],this._cookieAuthData={},ye.registerCookieChecker({isApplicable:function(e){return!(e.indexOf("access_token")>0||e.indexOf(".svc.ms/transform/thumbnail")<0);},check:function(e){var t=new d.e();return n._haveCookies.getPromise().done(function(e){return t.complete(e);},function(e){return t.error(e);}),t.getPromise();}});}return e.prototype.canUseCookies=function(){return!(!this._cookieAuthData.active&&this._cookieState!==ge.Pending);},e.prototype.trackItem=function(e){this._cookieAuthData.active||this.itemsWaitingForCookies.push(Object(o.e)({},e));},e.prototype.checkCookies=function(e,t){if(this._cookieState!==ge.Failed&&t&&t.supportsCookies&&(this._cookieAuthData.mostRecent=t,this._cookieState!==ge.Pending))if(this._cookieAuthData.active){if(this._cookieAuthData.active!==t){var n=Date.now()-this._cookieAuthData.active.timeReceived.getTime();n>432e5&&(this._haveCookies=new d.e(),this._cookieAuthData.active=void 0),n>72e5&&this._updateCookies(e,t);}}else this._updateCookies(e,t);},e.prototype._updateCookies=function(e,t){var n=this,a=this._cookieState===ge.None;this._cookieState=ge.Pending,this._makeImageRequest(e,t,a).then(function(){n._cookieAuthData.active=t,n._cookieState=ge.Success,n.itemsWaitingForCookies.length=0,n._haveCookies.complete(!0);},function(){n._cookieState=ge.Failed,n._updateThumbnailUrls(t),n._haveCookies.error(!1);});},e.prototype._makeCorsRequest=function(e,t){var n,a=this;e+="/Auth/SetCookies?provider=spo";var i=ae.e.isFeatureEnabled(x),r=i?t.authTokenV21:t.authToken,o=i?t.proofTokenV21:t.proofToken;return this._platform.isIE&&this._platform.browserMajor<=10?(e+="&access_token="+r,e+="&prooftoken="+o):n={spo_access_token:r,spo_prooftoken:o},this.sendCorsRequest(e,n).then(function(t){if(!t.isOldCookiePresent)return a.sendCorsRequest(e,n).then(function(e){if(!e.isOldCookiePresent)return _e.t.wrapError("Cookie request succeeded, but the cookies are not actually being set");});});},e.prototype.sendCorsRequest=function(e,t){return he.e.start({withCredentials:!0,url:e,headers:t,method:"POST"}).then(function(e){var t;try{t=JSON.parse(e.responseText);}catch(e){}return t||_e.t.reject("Expected response object but received nothing");});},e.prototype._makeImageRequest=function(e,t,n){var a=ae.e.isFeatureEnabled(x),i=a?t.authTokenV21:t.authToken,r=a?t.proofTokenV21:t.proofToken;return e+="/Auth/SetCookiesImg?provider=spo",e+="&access_token="+i,be(e+="&prooftoken="+r).then(function(){if(n)return be(e+"&throwOnMissingCookies=true");});},e.prototype._updateThumbnailUrls=function(e){this.itemsWaitingForCookies.length&&this._updateThumbnailUrlCallback(this,e);},e;}()),De=n(543),Ie=new c.t({name:"ItemTaskObserver.key",loader:new s.t(function(){return n.ee(2,743).then(function(e){return e.resourceKey;});})}),xe=n(637),Ce=new c.t({name:"updateThumbnailUrlCallback",factory:{dependencies:{itemTaskObserverTypeAsync:Ie.async,resourceScopeKey:c.i},create:function(e){return{instance:function(t,a){Object(o.t)(this,void 0,void 0,function(){var i,r,s,c,d;return Object(o.i)(this,function(o){switch(o.label){case 0:return i=e.itemTaskObserverTypeAsync,[4,e.resources.consumeAsync(xe.e.optional)];case 1:return o.sent(),[4,Promise.all([i(),n.ee(2,743)])];case 2:return r=o.sent(),s=r[0],c=r[1].Task,(d=new s()).update(t.itemsWaitingForCookies.map(function(e){var n=e.itemKey,i=Object(De.A)(De.m),r=i?a.authTokenV21:a.authToken,o=i?a.proofTokenV21:a.proofToken,s=e.thumbnailUrl+"&access_token=".concat(r,"&prooftoken=").concat(o),d=t.thumbnailHelper.getThumbnail({baseUrl:s,itemKey:n,fileExtension:e.fileExtension,mediaServiceMetadata:e.mediaServiceMetadata});return new c(n).succeed({item:{key:n,thumbnail:me.replace(d)}});})),t.itemsWaitingForCookies.length=0,d.flush(),[2];}});});}};}}}),Oe=Object(s.r)("AuthCookieHelper",Se,{thumbnailHelper:ue,platformDetection:fe.e,updateThumbnailUrlCallback:Ce}),we=n(50),Ee=n(28),Ae=n(664),Le=(function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=t.dataStoreType,a=void 0===n?we.e:n;this._dataStore=new a("MediaAuthStore",Ee.e.session);}return e.prototype.getToken=function(e,t){if(e){var n=this._dataStore.getValue(e);if(n&&!Object(Ae.e)(n,36e5))return n;this._dataStore.setValue(e,t);}return t;},e;}()),ke=Object(s.r)("AuthTokenStore",Le,{}),Me=n(683),Pe=new s.n(F,{pageContext:H.t,thumbnailHelper:ue,metaDataProcessor:pe,authCookieHelper:Oe,authTokenStore:ke,authTokenDataSource:Me.e}),Te=new c.t({name:"".concat("MicroServiceDataSource",".type"),factory:{dependencies:{resources:c.i},create:function(e){return{instance:(function(t){function n(){var n=this,a=new c.n(e.resources);return a.bind(pe),(n=t.call(this,{},a.resolve(Pe.dependencies))||this)._resources=a,n;}return Object(o.a)(n,t),n.prototype.dispose=function(){this._resources.dispose();},n;}(F))};}}}),Ue=new c.t({name:"MicroServiceDataSource",factory:Pe});}}]);