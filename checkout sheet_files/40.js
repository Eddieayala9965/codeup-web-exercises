 if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas-gov.us/js-bootstrap.js?saasId=11394&type=WORKER&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas-gov.us/js-bootstrap.js?saasId=11394&type=WINDOW&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[40,49],{524:function(e,t,n){"use strict";var a;!function(e){e[e.Files=0]="Files",e[e.Recent=1]="Recent",e[e.DocumentLibraries=2]="DocumentLibraries",e[e.SharedWithMe=3]="SharedWithMe",e[e.DocsInCommon=4]="DocsInCommon",e[e.RecycleBin=5]="RecycleBin",e[e.Photos=6]="Photos",e[e.Search=7]="Search",e[e.AllMyPhotos=8]="AllMyPhotos",e[e.AccountChooserPicker=9]="AccountChooserPicker",e[e.AccountChooserMobileSDK=10]="AccountChooserMobileSDK",e[e.Popular=11]="Popular",e[e.RecentUnpopular=12]="RecentUnpopular",e[e.SecondStageRecycleBin=13]="SecondStageRecycleBin",e[e.Apps=14]="Apps",e[e.Subsites=15]="Subsites",e[e.RecentActivity=18]="RecentActivity",e[e.ExternallyShared=19]="ExternallyShared",e[e.SharedByMe=20]="SharedByMe",e[e.Favorites=21]="Favorites",e[e.DetailsPane=22]="DetailsPane",e[e.Channels=24]="Channels",e[e.PhotoStream=25]="PhotoStream",e[e.PhoneLink=26]="PhoneLink",e[e.DefaultDocLib=27]="DefaultDocLib",e[e.ListSyncIssues=28]="ListSyncIssues",e[e.OneDriveHome=29]="OneDriveHome",e[e.TeamsDownloads=30]="TeamsDownloads",e[e.MyLists=31]="MyLists",e[e.Selection=32]="Selection",e[e.People=33]="People",e[e.Meetings=34]="Meetings",e[e.RecentLists=35]="RecentLists",e[e.MyOrganizationAssets=36]="MyOrganizationAssets",e[e.LargestFiles=37]="LargestFiles"}(a||(a={})),t.e=a},548:function(e,t,n){"use strict";var a=n(524);n.d(t,"e",function(){return a.e})},570:function(e,t,n){"use strict";function a(e,t){return e===t}n.d(t,"e",function(){return a})},571:function(e,t,n){"use strict";var a=n(548);t.e=function(e){void 0===e&&(e=""),this.isDropEnabled=!1,this.permissions={High:0,Low:0},this.key=e,this.revision=0,this.queryType=a.e.Files,this.displayType=a.e.Files,this.isPlaceholder=!0,this.properties={},this.recycleBinProperties={},this.reputationProperties={},this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0},this.urls={},this.state={upload:{status:5},removing:!1}}},574:function(e,t,n){"use strict";n.d(t,"n",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"t",function(){return f});var a=n(0),i=(n("knockout-projections-lib"),n(44)),r=n("knockout-lib");r.onError=function(e){i.e.log(e)};var o=n(131),s=n(107),c=n(570),d=n(287);function l(e){return f(e)?e.peek():e}function u(e){return r.unwrap(e)}function f(e){return r.isObservable(e)}var p=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this._owner=e.owner,this._asyncType=t.asyncType}return Object.defineProperty(e.prototype,"scope",{get:function(){return this._scope||(this._scope=new o.e)},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e,t,n){var a,i=(void 0===n?{}:n).isBeforeChange;return void 0!==i&&i&&(a="beforeChange"),this.scope.attach(e.subscribe(t,this._owner,a))},e.prototype.create=function(e,t){var n=r.observable(e),a=null==t?void 0:t.equalityComparer;return a&&(n.equalityComparer=a),n},e.prototype.createArray=function(e){return r.observableArray(e)},e.prototype.createCallback=function(e){var t=0,n=this.create({}),i=e.defaultValue,r=e.reducer,o=this.pureCompute(function(){return Object.keys(n()).map(function(e){return n()[e]}).reduce(function(e,t){return r(e,u(t))},u(i))},{equalityComparer:c.e});return Object(d.e)(o,{register:function(e){var i,r="".concat(++t);return n(Object(a.e)(Object(a.e)({},n.peek()),((i={})[r]=e,i))),{dispose:function(){var e=n.peek(),t=r,i=(e[t],Object(a.r)(e,["symbol"==typeof t?t:t+""]));n(i)}}}})},e.prototype.compute=function(e,t){var n=this;void 0===t&&(t={});var i=function(e){return"object"==typeof e}(e)?e:{read:e},o=Object(a.e)(Object(a.e)({owner:this._owner,disposeWhen:function(){return n.scope.isDisposed}},i),t),s=o.equalityComparer,c=Object(a.r)(o,["equalityComparer"]),d=r.computed(c);return s&&(d.equalityComparer=s),this.scope.attach(d)},e.prototype.pureCompute=function(e,t){return void 0===t&&(t={}),this.compute(e,Object(a.e)({pure:!0},t))},e.prototype.backgroundCompute=function(e,t){var n={deferEvaluation:!0};return t&&r.utils.extend(n,t),this._setupBackgroundTask(this.compute(e,n))},e.prototype.wrap=function(e,t){return f(e)?e:this.create(e,t)},e.prototype.peekUnwrap=function(e){return f(e)?e.peek():e},e.prototype.unwrap=function(e){return u(e)},e.prototype.isObservable=function(e){return f(e)},e.prototype.ignore=function(e){return function(e){return r.ignoreDependencies(e)}(e)},e.prototype.dispose=function(){this._scope&&this._scope.dispose()},e.prototype._setupBackgroundTask=function(e){var t=this;return this._backgroundTasks||(this._backgroundTasks=[]),this._backgroundTasks.push(e),this._backgroundTasksTimeoutId||(this._backgroundTasksTimeoutId=this._getAsync().setImmediate(function(){return t._runBackgoundTasks()})),e},e.prototype._runBackgoundTasks=function(){for(;this._backgroundTasks.length;)this._backgroundTasks.shift()();delete this._backgroundTasksTimeoutId,delete this._backgroundTasks},e.prototype._getAsync=function(){var e=this._asyncType||s.e,t=this.scope.attach(new e(this));return this._getAsync=function(){return t},t},e}();t.e=p},580:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.any=0]="any",e[e.file=1]="file",e[e["!file"]=-1]="!file",e[e.folder=2]="folder",e[e["!folder"]=-2]="!folder",e[e.media=3]="media",e[e["!media"]=-3]="!media",e[e.photo=4]="photo",e[e["!photo"]=-4]="!photo",e[e.video=5]="video",e[e["!video"]=-5]="!video",e[e.document=6]="document",e[e["!document"]=-6]="!document",e[e.audio=7]="audio",e[e["!audio"]=-7]="!audio",e[e.word=8]="word",e[e["!word"]=-8]="!word",e[e.powerpoint=9]="powerpoint",e[e["!powerpoint"]=-9]="!powerpoint",e[e.excel=10]="excel",e[e["!excel"]=-10]="!excel",e[e.onenote=11]="onenote",e[e["!onenote"]=-11]="!onenote",e[e.zip=12]="zip",e[e["!zip"]=-12]="!zip",e[e.pdf=13]="pdf",e[e["!pdf"]=-13]="!pdf",e[e.text=14]="text",e[e["!text"]=-14]="!text",e[e.listItem=15]="listItem",e[e["!listItem"]=-15]="!listItem"}(a||(a={}))},593:function(e,t,n){"use strict";function a(e){var t;t={};for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o="".concat(r);t[o]||(t[o]=!0,n.push(r))}return n}n.d(t,"e",function(){return a})},609:function(e,t,n){"use strict";var a=n(0),i=n(11),r=n(93),o=n(72),s=n(107),c=n(574),d=n(55),l="@ms/odsp-shared/lib/base/BaseModel",u=new i.t({name:"".concat(l,".asyncType"),factory:new i.e(s.e)}),f=new i.t({name:"".concat(l,".observablesFactoryType"),factory:new r.a(c.e,{asyncType:u.optional})}),p=new i.t({name:"".concat(l,".eventGroupType"),factory:new i.e(o.t)}),m=new i.t({name:"".concat(l,".errorHandler")}),_=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=t.id,r=void 0===i?"":i;return a.id=r,a._BaseModel_dependencies=n,a}return Object(a.a)(t,e),Object.defineProperty(t.prototype,"async",{get:function(){return this._BaseModel_getAsync()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return this._BaseModel_getEvents()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"observables",{get:function(){return this._BaseModel_getObservables()},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(e,t,n){return this.observables.subscribe(e,t,{isBeforeChange:n})},t.prototype.createComputed=function(e,t){return this.observables.compute(e,t)},t.prototype.createPureComputed=function(e,t){return this.observables.pureCompute(e,t)},t.prototype.createBackgroundComputed=function(e,t){return this.observables.backgroundCompute(e,t)},t.prototype.addDisposable=function(e){return this.scope.attach(e)},t.prototype.trackPromise=function(e){var t=!1,n=this.scope.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),a=function(){t=!0,n.dispose()};return e.done(a,a),e},t.prototype.wrapObservable=function(e){return this.observables.wrap(e)},t.prototype.peekUnwrapObservable=function(e){return Object(c.n)(e)},t.prototype.createObservable=function(e){return this.observables.create(e)},t.prototype.unwrapObservable=function(e){return Object(c.a)(e)},t.prototype.isObservable=function(e){return Object(c.t)(e)},t.prototype._BaseModel_getAsync=function(){var e=new(this.scope.attached(this._BaseModel_getAsyncType()))(this,this._BaseModel_getErrorHandler());return this._BaseModel_getAsync=function(){return e},e},t.prototype._BaseModel_getEvents=function(){var e=new(this.scope.attached(this._BaseModel_getEventGroupType()))(this,this._BaseModel_getErrorHandler());return this._BaseModel_getEvents=function(){return e},e},t.prototype._BaseModel_getObservables=function(){var e=new(this.scope.attached(this._BaseModel_getObservablesFactoryType()))({owner:this});return this._BaseModel_getObservables=function(){return e},e},t.prototype._BaseModel_getAsyncType=function(){return this._BaseModel_dependencies.asyncType||this.resources&&this.resources.consume(u.optional)||s.e},t.prototype._BaseModel_getEventGroupType=function(){return this._BaseModel_dependencies.eventGroupType||this.resources&&this.resources.consume(p.optional)||o.t},t.prototype._BaseModel_getObservablesFactoryType=function(){return this._BaseModel_dependencies.observablesFactoryType||this.resources&&(this.resources.consume(f.optional)||Object(i.a)(c.e,{asyncType:this._BaseModel_getAsyncType()}))||c.e},t.prototype._BaseModel_getErrorHandler=function(){return this._BaseModel_dependencies.errorHandler||this.resources&&this.resources.consume(m.optional)},t.dependencies=Object(a.e)(Object(a.e)({},d.e.dependencies),{asyncType:u.optional,observablesFactoryType:f.optional,eventGroupType:p.optional,errorHandler:m.optional}),t}(d.e);t.e=_},610:function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n(0),i=n(571),r=n(50),o=n(574),s=n(11),c=n(93),d=n(216),l=n(570),u=n(288),f=n(593),p=n(257),m=n(543),_=Object(m.A)(m.S),h="token=",b="result=",g="item_write=",v="item=";function y(e){return e&&e.item&&e.item.peek().key}function S(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null,n.items=[],t.valueHasMutated()}var D=function(e){function t(){var t=e.call(this,"ItemsStore")||this;return t._itemSetsKeys={},t._observables=new o.e({owner:t}),t._vaultItemsToPurge=[],window.odstore=t,t}return Object(a.a)(t,e),t.prototype.dispose=function(){this._observables.dispose()},t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(a.o)([e],t,!1))},t.prototype.getItem=function(e){return this.getValue(v+e)},t.prototype.setItemSet=function(e,t){var n=b+e;this.setValue(n,t),this._itemSetsKeys[n]=1},t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var a=(t=this.getValue(n)).content&&t.content.peek(),i=a&&a.items;if(i)for(var r=0,o=i;r<o.length;r++){var s=o[r];if(s&&s.peek().parentKey===e)return t}}},t.prototype.getItemSet=function(e){return this.getValue(b+e)},t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice(b.length));return e},t.prototype.setNextRequestToken=function(e,t,n){var a=h+t;n?this.setValue(a,n):this.remove(a)},t.prototype.getNextRequestToken=function(e){return this.getValue(h+e)},t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,a=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),a)},t.prototype.invalidateItemSet=function(e){var t=this.getValue(b+e);t&&S(t)},t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&S(t)},t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a),r=i&&i.locationFilter;r&&r.indexOf(e)>=0&&(t.isExpired=!0)}}},t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a);i&&i.tagFilter===e&&(t.isExpired=!0)}}},t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();n&&n.key&&n.key.indexOf("allmyphotos")>=0&&(e.isExpired=!0,this._invalidateItem(n))}},t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(a.o)([],this._vaultItemsToPurge,!0);e<t.length;e++){var n=t[e],r=void 0;n.vault&&n.vault.root&&((r=new i.e(n.key)).name=n.name,r.displayName=n.displayName,r.dateModified=" ",r.folder={},r.vault={isLocked:!0,root:{}}),this._purgeItem(n,r)}this._vaultItemsToPurge=[]},t.prototype._handleItemInvalidation=function(e,t,n){var a=this;if(t){var i=t.peek(),r=!1,o=[];if(i)switch(o.push(i),i.type){case u.e.Folder:case u.e.Media:r=!0}for(var s in this._itemSetsKeys){var c=this.getValue(s),d=c.item&&c.item.peek(),l=d&&d.key;l&&(l===e||r&&l.indexOf("allmyphotos")>-1)&&(l===e?this.setNextRequestToken(e,c.key,""):o.push(d),c.isExpired=!0)}o.forEach(n?function(e){return a._purgeItem(e)}:function(e){return a._invalidateItem(e)})}},t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)},t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e),Object(p.default)(t,{revision:e.revision+1}),this.setItem(t)},t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];_&&!Object.isFrozen(e)&&Object.freeze(e),e.vault&&this._vaultItemsToPurge.push(e);for(var r=function(t){var n="".concat(v).concat(t),a=_?"".concat(g).concat(t):n,r=o.getValue(n),s=o.getValue(a);s?s(e):((s=o._observables.create(e)).equalityComparer=l.e,o.setValue(a,s),r=_?o._observables.pureCompute(function(){return s()}):s,o.setValue(n,r)),i.push(r)},o=this,s=0,c=Object(f.e)(Object(a.o)([e.key],t,!0));s<c.length;s++){var d=c[s];r(d)}return i[0]},t}(r.e),I=new s.t({name:"ItemsStore",factory:new c.i(D)})},623:function(e,t,n){"use strict";var a=function(){function e(e,t){!function(e){return!!e&&"object"==typeof e}(e)?(this.key=e,this.input=t,this.status=0):(this.key=e.key,this.input=e.input,this.output=e.output,this.status=e.status,this.error=e.error)}return e.prototype.succeed=function(t){var n=new e(this);return n.output=t,n.status=1,delete n.error,n},e.prototype.fail=function(t){var n=new e(this);return n.error=t,n.status=2,n},e.prototype.cancel=function(){var t=new e(this);return delete t.error,t.status=3,t},e.prototype.restart=function(){return new e(this.key,this.input)},e.prototype.changeInput=function(t){var n=t(this.input),a=new e(this.key,n);return a.output=this.output,a.status=this.status,a.error=this.error,a},e.prototype.changeOutput=function(t){var n=t(this.output),a=new e(this.key,this.input);return a.output=n,a.status=this.status,a.error=this.error,a},e.prototype.compare=function(e){return e&&this.input===e.input&&this.output===e.output&&this.error===e.error&&this.status===e.status?null:{previous:e,current:this}},e}();t.e=a},743:function(e,t,n){"use strict";n.r(t),n.d(t,"ItemTaskObserver",function(){return u}),n.d(t,"resourceKey",function(){return f});var a=n(0),i=n(609),r=n(623);n.d(t,"Task",function(){return r.e});var o=n(571),s=n(610),c=n(257);n.d(t,"Graft",function(){return c});var d=n(11),l=n(93),u=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.itemsStore,r=void 0===i?a.resources.consume(s.e):i;return a._itemsStore=r,a._itemUpdatesByKey={},a}return Object(a.a)(t,e),t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,a=e;n<a.length;n++){var i=a[n];this._processTask(i)}},t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,n=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,r=n;i<r.length;i++){var s=r[i],d=t[s],l=new o.e(s),u=this._getStoreItem(s);if(u){u.UNSAFE_parent;var f=Object(a.r)(u,["UNSAFE_parent"]);Object(c.default)(l,f)}Object(c.default)(l,{revision:0});for(var p=0,m=d.item;p<m.length;p++){var _=m[p];Object(c.default)(l,_)}e[s]=l}for(var h=0,b=n;h<b.length;h++){var g=(l=e[s=b[h]]).parentKey;if(g){var v=e[g]||this._getStoreItem(g)||new o.e(g);e[g]=v,l.UNSAFE_parent=v}else delete l.UNSAFE_parent}this._pushItemsToStore(e);for(var y=0,S=n;y<S.length;y++)s=S[y],delete(d=t[s]).item},t.prototype.reset=function(){this._itemUpdatesByKey={}},t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)},t.prototype.getChildren=function(e){var t,n,a,i=e.parentKey,r=e.startIndex,o=e.endIndex,s=[],c=this._itemUpdatesByKey[i];if(c){var d=c.set;if(d)if(d.childrenByIndex){r=void 0===(n=(t={startIndex:r,endIndex:o}).startIndex)?d.startIndex:n,o=void 0===(a=t.endIndex)?d.endIndex:a;for(var l=r;l<o;l++){var u=d.childrenByIndex[l],f=this._getStoreItem(u);s.push(f)}}else if(d.childrenBySibling)for(var p={},m="";m=d.childrenBySibling[m];){if(p[m])throw new Error("Circular reference encountered enumerating the children of '".concat(i,"'."));p[m]=!0,f=this._getStoreItem(m),s.push(f)}}return s},t.prototype._processTask=function(e){var t=e.key,n=e.output,a=n.item,i=n.set,r=this._itemUpdatesByKey,o=r[t];if(o||(o=r[t]={}),a&&(o.item||(o.item=[]),o.item.push(a)),i){var s=r[i.parent.key];s||(s=r[i.parent.key]={}),s.set||(s.set={});var c=s.set;if(void 0!==i.index){c.childrenByIndex||(c.childrenByIndex=[]),void 0===c.startIndex?c.startIndex=i.index:c.startIndex=Math.min(c.startIndex,i.index);var d=c.childrenByIndex.length;c.childrenByIndex[i.index]=t,void 0===c.endIndex?c.endIndex=i.index+1:c.endIndex>i.index+1?c.endIndex+=c.childrenByIndex.length-d:c.endIndex=Math.max(c.endIndex,i.index+1)}else i.after&&(c.childrenBySibling||(c.childrenBySibling={}),c.childrenBySibling[i.after.key]=t)}},t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)},t.prototype._pushItemsToStore=function(e){var t={};for(var n in e)(r=t[i=e[(c=e[n]).parentKey]&&c.parentKey||""]||(t[i]=[])).push(n);for(var a=[""];a.length;){var i,r;if(r=t[i=a.shift()]){for(var o=0,s=r;o<s.length;o++){var c;if(!(c=e[n=s[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(c,n)}a.push.apply(a,r)}}},t.dependencies=Object(a.e)(Object(a.e)({},i.e.dependencies),{itemsStore:s.e}),t}(i.e),f=new d.t({name:"ItemTaskObserver",factory:new l.a(u)});t.default=u},858:function(e,t,n){"use strict";n.r(t),n.d(t,"KnockoutAuthTokenDataSource",function(){return le}),n.d(t,"resourceKey",function(){return ue});var a=n(0),i=n(62),r=n(8),o=n(100),s=n(39),c=n(330),d=n(3);function l(e,t){var n=[];return e&&(t||n.push("&"),n.push("@listUrl='"),n.push(s.e.encodeRestUriStringToken(e)),n.push("'"),t&&n.push("&")),n.join("")}var u,f=n(580),p=n(18),m="ViewFields",_="Query",h="Where";function b(e){var t;try{t=u.parseFromString(e,"application/xml")}catch(e){throw new Error("Invalid XML (exception thrown)")}if(!t.documentElement)throw new Error("Invalid XML (documentElement does not exist)");if(t.querySelector("parsererror"))throw new Error("Invalid XML (parsererror found)");return t}window.DOMParser&&(u=new DOMParser),n(36);var g=function(){var e=new(0,window.XMLSerializer);return g=function(){return e},e};var v='<Eq><FieldRef Name="ProgId" /><Value Type="Text">OneNote.Notebook</Value></Eq>',y='<Neq><FieldRef Name="ProgId" /><Value Type="Text">OneNote.Notebook</Value></Neq>';function S(e){return e.reduce(function(e,t){return e&&t?"<Or>".concat(e).concat(t,"</Or>"):t||e},"")}function D(e,t,n,a){if(!n||0===n.length)return"";var i='<FieldRef Name="'.concat(e,'" />'),r=t?n.map(function(e){return'<Value Type="'.concat(t,'">').concat(e,"</Value>")}):n;return"".concat(1===r.length?"".concat(a?"<Neq>":"<Eq>").concat(i).concat(r[0]).concat(a?"</Neq>":"</Eq>"):"<In>".concat(i,"<Values>").concat(r.join(""),"</Values></In>"))}var I,x=n(162),C=n(221),O=n(48),w=d.t.isActivated("4D69327F-16ED-4A50-8ABF-F476ABC4E29B","05/04/2023","should only retry request when groupReplace was not true in the context"),E=d.t.isActivated("23DCF7B8-CE78-43EA-8F10-7B5CD47411D5","05/04/2023","return retriedWithGroupReplaceContext as part of listItemResponse"),A=d.t.isActivated("270dfbb4-1b85-4fed-9ada-b85e650353f4","6/9/22","retry request for large list"),L=d.t.isActivated("3f7e1f54-43e3-4c37-a5f3-b78fb07ed315","7/12/22","read groupString from postDataContext when listContext group is empty"),k=d.t.isActivated("c49d1ed9-cfb5-4a27-ab34-801c001bcb9f","4/12/2023"),M=function(e){function t(t){return e.call(this,{dataSourceName:"ListItemDataSource"},{pageContext:t.pageContext})||this}return Object(a.a)(t,e),t.prototype.getItem=function(t,n,a,r,o,s){var c=this;t.postDataContext.isOnePage=!!t.newTargetListUrl||!!t.isOnePageNavigation;var d=t.remoteItem?this._getRemoteItemPostData():this.getAdditionalPostData(t.postDataContext,n,t.pageSize),l=function(){return t.remoteItem?c._getRemoteItemPostData():c.getAdditionalPostData(t.postDataContext,n,t.pageSize)};return(!k&&this.getUrlAsync?this.getUrlAsync(n,t):i.t.resolve(void 0)).then(function(u){var f=function(f){return e.prototype.getData.call(c,u?function(){return u}:function(){return c.getUrl(n,t)},function(e,t){return c._parseResponse(e,a.qosEvent,t,f)},a.qosName,A?function(){return d}:l,"POST",c._getListRequestHeaders(t,n,a),void 0,void 0,t.noRedirect,void 0,function(e){var t=c._telemetryHandler(e);return r&&r(t.eventData),t},void 0,t.authToken,void 0,o,s).then(function(e){return e},function(e){return c._errorHandler(a.qosName,e),i.t.reject(e)})};return f().then(function(e){return e},function(e){var n;return A||-1===(null===(n=e.code)||void 0===n?void 0:n.indexOf("Microsoft.SharePoint.SPQueryThrottledException"))||!w&&t.postDataContext.groupReplace?i.t.reject(e):(t.postDataContext.groupReplace=!0,f(!0))})})},t.prototype.getUrl=function(e,t){var n,a=t&&t.postDataContext;return n={webUrl:this._pageContext.webAbsoluteUrl,listId:t.remoteItem?t.remoteItem.ListId:e.listId,urlParts:t.remoteItem?{}:e.urlParts,searchTerm:e.searchTerm,rootFolder:t.remoteItem?void 0:e.folderPath,isOnePageNavigation:t.isOnePageNavigation,remoteWebUrl:t.remoteItem?t.remoteItem.SiteUrl:t.remoteWebUrl,uniqueId:t.remoteItem&&t.remoteItem.UniqueId,authToken:null==t?void 0:t.authToken,inplaceSearchMultiLineFieldQuery:e.inplaceSearchMultiLineFieldQuery},d.t.isActivated("03784CEA-7833-4740-8D6A-4EA05116664F","5/18/21","Set prefetch param")||(n.isPrefetchPageContext=e.listId&&!this._pageContext.listUrl),this._isSpecifiedItemRequest(e)?n.viewId=e.viewIdForRequest:((!e.viewXmlForRequest||a&&a.isOnePage)&&e.viewIdForRequest!==O.e.Empty&&(n.view=e.viewIdForRequest),!n.view&&e.viewPathForRequest&&(n.viewPath=e.viewPathForRequest),t&&t.ignoreFilterParams||(n.filterParams=e.filterParams),e.sortField&&(n.sortField=e.sortField,n.sortDir="false"===e.isAscending?"Desc":"Asc"),a&&a.groupReplace?n.requestToken=this._isExpandingGroup(n.groupString)?void 0:e.requestToken:n.requestToken=e.group?void 0:e.requestToken,!e.group||!this._isExpandingGroup(e.group.groupString)||a&&a.groupReplace?L||!t.group||!this._isExpandingGroup(t.group.groupString)||a&&a.groupReplace||(n.groupString=t.group.groupString):n.groupString=e.group.groupString,a&&a.webId&&(n.webId=a.webId)),function(e){var t,n,a=e.webUrl,i=e.webId,r=e.listId,u=e.view,f=e.searchTerm,p=e.rootFolder,m=e.sortField,_=e.sortDir,h=e.filterParams,b=e.groupString,g=e.requestToken,v=e.viewId,y=e.viewPath,S=e.urlParts,D=e.isOnePageNavigation,I=e.isPrefetchPageContext,x=e.uniqueId,C=e.remoteWebUrl,O=e.authToken,w=e.inplaceSearchMultiLineFieldQuery,E=C?[s.e.escapeUrlForCallback(C)]:[s.e.escapeUrlForCallback(a)];(C&&"/"!==C.slice(-1)||"/"!==a.slice(-1))&&E.push("/"),S&&(n=void 0===(t=S.siteRelation)?S.isCrossSite:t);var A=n!==o.a.sameSite;if(!O&&S&&(A||i)&&S.fullListUrl&&!D){E.push("_api/SP.List.GetListDataAsStream?listFullUrl='");var L=S.fullListUrl;if(C&&(L=new URL(C).origin+S.serverRelativeItemUrl),E.push(s.e.encodeRestUriStringToken(L)),g)return"?"!==g[0]&&c.e.logData({name:"ListItemDataHelper.InvalidRequestToken",message:g}),E.push("'&"+g.substring(1)),E.join("");E.push("'&View=")}else{var k=S&&S.serverRelativeListUrl;if(k||(k=S&&S.serverRelativeItemUrl),k&&!I?E.push("_api/web/GetList(@listUrl)"):r?(E.push("_api/web/lists/GetById('"),E.push(r),E.push("')")):E.push("_api/web/DefaultDocumentLibrary"),g)return E.push("/RenderListDataAsStream"),E.push(g),E.push(l(k)),"string"==typeof f&&(E.push("&InplaceSearchQuery="),E.push(s.e.encodeURIComponent(f))),E.join("");E.push("/RenderListDataAsStream?"),k&&E.push(l(k,!0)),E.push("View="),u&&E.push(u),y&&(E.push("&ViewPath="),E.push(s.e.encodeURIComponent(y)))}return v&&E.push("&ViewId=".concat(v)),"string"==typeof f&&(E.push("&InplaceSearchQuery="),E.push(s.e.encodeURIComponent(f))),p&&(E.push("&RootFolder="),E.push(s.e.encodeURIComponent(p))),x&&(E.push("&RootFolderUniqueId="),E.push(s.e.encodeURIComponent(x))),"string"==typeof b&&(E.push("&IsGroupRender=TRUE"),E.push("&DrillDown=1"),E.push("&GroupString=".concat(b))),m&&E.push("&SortField=".concat(m)),_&&E.push("&SortDir=".concat(_)),h&&(h.startsWith("&")||d.t.isActivated("8bcd8267-4968-45bc-b7f3-4cd9135477f7","3/07/2023","add & before filter params")?E.push(h):E.push("&".concat(h))),w&&(E.push("&InplaceSearchMultiLineFieldQuery="),E.push(s.e.encodeURIComponent(w))),E.join("")}(n)},t.prototype.getAdditionalPostData=function(e,t,n){return function(e,t,n){var a=function(e){var t=e.context,n=e.listContext,a=e.pageSize,i=t.viewXml,r=t.firstGroupOnly,s=t.expandGroups,c=t.allowMultipleValueFilterForTaxonomyFields,l=t.groupByOverride,u=t.requestDatesInUtc,f=t.groupReplace,p=t.additionalFiltersXml,v=t.mergeDefaultView,y=t.showStubFile,S=t.modernListBoot,D=t.requireFolderColoringFields,I=function(e){return"undefined"!=typeof _spPageContextInfo&&_spPageContextInfo&&_spPageContextInfo.webTemplate&&(e.webTemplate=_spPageContextInfo.webTemplate),function(e){var t=e.disableAutoHyperlink,n=e.fieldNames,a=void 0===n?[]:n,i=e.needsSchema,r=e.needsContentTypes,o=e.needsListAvailableContentTypes,s=e.needsContentTypeOrder,c=e.needsGridInitInfo,d=e.needsForms,l=e.needsQuickLaunch,u=e.needsSpotlight,f=e.needsViewMetadata,p=e.needsParentInfo,m=e.needsMountPoint,_=e.requestToken,h=e.isListDataRenderOptionChangeFeatureEnabled,b=e.isSpotlightFeatureEnabled,g=e.needUpdatePageContext,v=e.needClientSideComponentManifest,y=e.renderCustomActions,S=e.renderSpfxCustomActions,D=e.preAuthorizedDownloadUrl,I=0;return(i||_)&&(i?(I|=7,h&&(I|=4096)):I|=2,a.indexOf("name.FileSystemItemId")>-1&&(I|=32)),r&&(I|=16),o&&(I|=65536),s&&(I|=131072),c&&(I|=262144),b&&u&&(I|=258),d?I|=64:h&&(I|=4098),l&&(I|=128),f&&(I|=1536),p&&(I|=8192),m&&(I|=1048576),g&&(I|=16384),v&&(I|=32768),t&&(I|=2048),y&&(I|=4194304),S&&(I|=2097152),D&&(I|=8388608),I}(e)}(t),x=!(n&&n.urlParts&&n.urlParts.siteRelation===o.a.crossSite),C=l||p||"number"==typeof a?function(e){var t="",n="",a=e.groupByField,i=e.fetchNextGroupXml,r=e.additionalFiltersXml,o=e.pageSize;e.disableGrouping?t="<GroupBy />":a&&(t='<GroupBy Collapse="FALSE"><FieldRef Name="'.concat(a,'"/></GroupBy>'));var s="";return i&&(s=i),r&&(s=s?"<And>".concat(s).concat(r,"</And>"):r),s&&(t+="<Where>".concat(s,"</Where>")),o&&(n="<RowLimit>".concat(o,"</RowLimit>")),t&&(t="<Query>".concat(t,"</Query>")),n||t?"<View>".concat(t).concat(n,"</View>"):""}({groupByField:l,additionalFiltersXml:i?void 0:p,pageSize:a}):void 0;i&&p&&(i=function(e){var t=e.viewXml,n=e.additionalFiltersXml;if(t&&n)try{var a=function(e){void 0===e&&(e="<View/>");var t,n,a,i,r,o,s,c,d,l,u,f=b(e),p=f.documentElement;if("View"!==p.tagName)throw new Error('View XML outer element tag name must be "View" (case-sensitive)');for(var g=0,v=p.childNodes.length;g<v;g++)(S=p.childNodes[g]).nodeType===Node.ELEMENT_NODE&&(S.tagName!==m||t?S.tagName!==_||n?"RowLimit"!==S.tagName||a?"NewDocumentTemplates"===S.tagName?i=S:"Aggregations"===S.tagName?r=S:"ViewType2"===S.tagName?o=S:"GridLayout"===S.tagName?s=S:"AssociatedContentTypeId"===S.tagName?c=S:"ViewData"===S.tagName?d=S:"CustomOrder"===S.tagName?l=S:"CalendarViewStyles"===S.tagName&&(u=S):a=S:n=S:t=S);t||(t=f.createElement(m),p.appendChild(t)),n||(n=f.createElement(_),p.appendChild(n)),r&&p.appendChild(r);var y={xmlDoc:f,view:p,query:n,viewFields:t,rowLimit:a,newDocumentTemplates:i,aggregations:r,viewType2:o,gridLayout:s,associatedContentTypeId:c,viewData:d,customOrder:l,viewStyles:u};for(g=0,v=n.childNodes.length;g<v;g++){var S;(S=n.childNodes[g]).nodeType===Node.ELEMENT_NODE&&("OrderBy"!==S.tagName||y.orderBy?"GroupBy"!==S.tagName||y.groupBy?S.tagName!==h||y.where||(y.where=S):y.groupBy=S:y.orderBy=S)}return y}(t),i=a.where;if(i||(i=a.xmlDoc.createElement(h),a.query.appendChild(i)),d.t.isActivated("A87EA41A-CD8C-42DB-908F-ACEFFB8CB988","4/30/2021","Get CombinedViewXml without using innerHTML as innerHTML property has some problems in IE"))i.innerHTML=i.innerHTML?"<And>"+i.innerHTML+n+"</And>":n;else{var r=b(i.childElementCount?"<And>"+g().serializeToString(i.firstElementChild)+n+"</And>":n).documentElement;i.childElementCount?i.replaceChild(r,i.firstElementChild):i.appendChild(r)}t=g().serializeToString(a.view)}catch(e){}return t}({viewXml:i,additionalFiltersXml:p}));var O={__metadata:{type:"SP.RenderListDataParameters"},RenderOptions:I>0?I:void 0,ViewXml:i||void 0,OverrideViewXml:C||void 0,AllowMultipleValueFilterForTaxonomyFields:c||void 0,AddRequiredFields:x||void 0,MergeDefaultView:v||void 0,FilterOutChannelFoldersInDefaultDocLib:t.filterOutChannelFoldersInDefaultDocLib||void 0};return S&&(O.ModernListBoot=!0),y&&(O.ShowStubFile=!0),u&&(O.DatesInUtc=!0),f&&(O.ReplaceGroup=!0),s&&(O.ExpandGroups=!0),r&&(O.FirstGroupOnly=!0),D&&(O.RequireFolderColoringFields=!0),O}({context:e,listContext:t,pageSize:n});return JSON.stringify({parameters:a})}(e,t,n)},t.prototype.needsRequestDigest=function(e){return!!d.t.isActivated("4CE25DD5-0B47-4B9E-B6F9-5037A00C6CF8","04/21/2021","need Request Digest")||-1===e.toLowerCase().indexOf("/renderlistdataasstream?")},t.prototype._getRemoteItemPostData=function(){return JSON.stringify({parameters:{RenderOptions:7}})},t.prototype._getListRequestHeaders=function(e,t,n){var a=function(e,t){var n,a,i,r;return t&&(n=t.needsQuickLaunch,a=t.webId,i=t.siteId),e.listUrl?r="listUrl=".concat(s.e.encodeURIComponent(e.listUrl)):e.listId&&(r="list=".concat(e.listId)),a&&(r+=",webId=".concat(a)),i&&(r+=",siteId=".concat(i)),{"X-SP-REQUESTRESOURCES":n?"NAVIGATIONSTRUCTURE,".concat(r):r}}(t,e.postDataContext);return n&&n.application&&(a.Application=n.application,a.Scenario="ViewList",a.ScenarioType="AUO"),a["X-ServiceWorker-Strategy"]=e.skipServiceWorkerCache?"SkipCache":"CacheFirst",a},t.prototype._isSpecifiedItemRequest=function(e){return e.itemIds&&e.itemIds.length>0},t.prototype._isExpandingGroup=function(e){return e&&"__next__"!==e},t.prototype._parseResponse=function(e,t,n,a){var i=n.getServiceWorkerDataSourceHeader();try{if(void 0!==e)return this._getListItemResponse(e,i,a)}catch(n){if("{}"!==e.substring(0,2))throw t.end({resultType:r.t.Failure,resultCode:"BadJSON"}),n;return this._getListItemResponse(e.substring(2),i,a)}},t.prototype._getListItemResponse=function(e,t,n){var a;return a=JSON.parse(e),"ServiceWorker-FromCache"===t&&(a.isFromServiceWorkerCache=!0),!E&&n&&(a.retriedWithGroupReplaceContext=!0),a},t.prototype._telemetryHandler=function(e){var t=e.errorData,n=Object(a.e)({},e.eventData);if(t){var i=void 0,o=t.code?t.code:"";return o.indexOf("2147024860")>-1?o="ListViewTreshold":o.indexOf("2147024749")>-1?o="LookupColumnTreshold":o.indexOf("2147024809")>-1&&o.indexOf("requestUrl")>-1?o="RequestURLFailure":o.indexOf("2147024809")>-1&&o.indexOf("range")>-1?o="RangeError":o.indexOf("2147024809")>-1&&o.indexOf("view")>-1?o="InvalidView":o.indexOf("2130575340")>-1&&o.indexOf("field")>-1?o="FieldTypesNotInstalledProperly":o.indexOf("2146232832")>-1?(o="DefaultDoclibNotFound",500===t.status&&(i=!1,n.resultType=r.t.ExpectedFailure)):o.indexOf("2147024895")>-1?(o="PrefetchWebMismatch",500===t.status&&(i=!1,n.resultType=r.t.ExpectedFailure)):o=n.resultCode,n.resultCode=o,{canRetry:i,eventData:n}}return{eventData:n}},t.prototype._errorHandler=function(e,t){var n=t&&t.code?t.code:"";n.indexOf("2147024860")>-1?C.e.logData({name:e+".ListViewTreshold"}):n.indexOf("2147024749")>-1&&C.e.logData({name:e+".LookupColumnTreshold"})},t}(x.t),P=n(93),T=n(286),U=n(548),F=n(52),H=n(623),R=n(593),N=n(539),B=n(287),j=n(288);!function(e){e.fromHexString=function(e,t){var n=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},a=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(a){var i=void 0,r=void 0;(e=(e=a[2]||"0").slice(-16)).length<=8?(i=0,r=parseInt(e,16)):(i=parseInt(e.slice(0,-8),16),r=parseInt(e.slice(-8),16)),isNaN(i)||isNaN(r)||(n.High=i,n.Low=r)}return n},e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})},e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}}}(I||(I={}));var V=I,z=n(109),G=n(257),K=n(218),W=n(30),q=function(){function e(){}return e.prototype.getUrlParts=function(e){return new Q(e)},e.dependencies={},e}(),Q=function(){function e(e){this._url=e}return Object.defineProperty(e.prototype,"driveId",{get:function(){return this._getDriveId()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"itemId",{get:function(){return this._getItemId()},enumerable:!1,configurable:!0}),e.prototype._getDriveId=function(){var e,t=this._getIndexOfDrivesSegment();if(t>-1){var n=this._getPathSegments();e=n[t+1]}return this._getDriveId=function(){return e},e},e.prototype._getItemId=function(){var e,t=this._getIndexOfItemsSegment();if(t>-1){var n=this._getPathSegments();e=n[t+1]}return this._getItemId=function(){return e},e},e.prototype._getPathSegments=function(){var e,t=this._url;return e=t?new W.e(t).getPathSegments():[],this._getPathSegments=function(){return e},e},e.prototype._getIndexOfDrivesSegment=function(){var e=this._getPathSegments().indexOf("drives");return this._getIndexOfDrivesSegment=function(){return e},e},e.prototype._getIndexOfItemsSegment=function(){var e=this._getPathSegments().indexOf("items");return this._getIndexOfItemsSegment=function(){return e},e},e}(),Y=Object(P.r)("VroomUrlHelper",q),J=n(261),X=n(216),Z=n(11),$=n(664),ee=n(538),te=n(799),ne=ee.e.isActivated("1E9F2B0E-270E-4F40-9918-01DD9B46C5F0","7/2/2021","Use the page context from the list response for Web data"),ae=ee.e.isActivated("1d0ede26-6eb5-4fcb-be71-789d486af357","11/10/2022","Use the page context from the list response for Web data"),ie=!1,re=function(){function e(e,t){this._urlDataSource=t.urlDataSource,this._pageContext=t.pageContext,this._itemUrlHelper=t.itemUrlHelper,this._vroomUrlHelper=t.vroomUrlHelper}return e.prototype.processResponse=function(e){var t=e.response,n=e.response,a=n.WebUrl,i=n.HttpRoot,r=n.ListData,o=n.rootFolder,s=n.ListSchema,c=(void 0===s?{}:s).Collapse,d=void 0===c?"FALSE":c,l=e.pageContext,u=e.requestKey,f=e.observer,p=this._urlDataSource.getKeyParams(u),m="TRUE"===d,_=this._itemUrlHelper.getItemUrlParts(u),h=this._itemUrlHelper.getUrlParts({path:_.serverRelativeListUrl,listUrl:_.fullListUrl});(a||i)&&this._processWeb({list:t,pageContext:l,requestKeyParts:p,observer:f});var b=this._processList({list:t,pageContext:l,listUrlParts:h,requestKeyParts:p,observer:f}).listRootItemKey,g=[];if(o){var v=this._processRootFolder({list:t,listUrlParts:h,requestKeyParts:p,observer:f});g.push.apply(g,v.parentItemUrls)}r&&!m&&(v=this._processListData({listData:r,listUrlParts:h,parentKey:u,requestKeyParts:p,observer:f}),g.push.apply(g,v.parentItemUrls));var y={};if(t.ParentInfo)for(var S=0,D=t.ParentInfo.ParentFolderInfo;S<D.length;S++){var I=D[S];y[I.ServerRelativeUrl]=V.fromHexString(I.Permissions)}for(var x=0,C=Object(R.e)(g);x<C.length;x++){var O=C[x];this._processParentItem({itemUrl:O,listUrlParts:h,parentInfo:y,requestKeyParts:p,observer:f})}return{listRootItemKey:b}},e.prototype._processListData=function(e){for(var t=e.listData.Row,n=e.parentKey,a=e.requestKeyParts,i=e.listUrlParts,r=e.observer,o=[],s="",c=0,d=t;c<d.length;c++){var l=d[c],u=l.FileRef,f=this._processRow({row:l,observer:r,requestKeyParts:a,listUrlParts:i}).key;o.push.apply(o,this._getParentItemUrls({listUrlParts:i,itemUrl:u})),r.update([new H.e(f).succeed({set:{parent:{key:n},after:{key:s}}})]),s=f}return{parentItemUrls:o}},e.prototype._processRow=function(e){var t,n,a,i=e.row,r=e.row.FileRef,o=e.listUrlParts,s=e.requestKeyParts,c=e.observer,d=this._itemUrlHelper.getUrlParts({path:r,listUrl:o.fullListUrl});if((t={})[T.t.idParamKey]=d.serverRelativeItemUrl,t[T.t.listUrlKey]=d.normalizedListUrl,a=t,this._isFolder(i)){var l={},u=this._urlDataSource.getQueryType(s),f=s[T.t.typeFiltersKey];u!==U.e.Search&&(l[T.t.queryTypeParamKey]=s[T.t.queryTypeParamKey]),f&&(l[T.t.typeFiltersKey]=f),B.e(a,l),s[T.t.metadataSearchIdKey]&&B.e(a,((n={})[T.t.metadataSearchIdKey]=s[T.t.metadataSearchIdKey],n))}var p=this._urlDataSource.getKey(a),m=this._getParentKeyForListItem({listUrlParts:o,itemUrl:r,requestKeyParts:s}),_={key:p};return m&&(_.parentKey=m),c.update([new H.e(p).succeed({item:_})]),{key:p}},e.prototype._processRootFolder=function(e){var t,n,a,i=e.list,r=e.listUrlParts,o=e.requestKeyParts,s=e.observer,c=i.rootFolder,d=this._itemUrlHelper.getUrlParts({path:c,listUrl:r.fullListUrl}),l=this._urlDataSource.getKey(((t={})[T.t.idParamKey]=d.serverRelativeItemUrl,t[T.t.listUrlKey]=d.normalizedListUrl,t[T.t.queryTypeParamKey]=o[T.t.queryTypeParamKey],t[T.t.queryParamKey]=o[T.t.queryParamKey],t[T.t.typeFiltersKey]=o[T.t.typeFiltersKey],t[T.t.metadataSearchIdKey]=o[T.t.metadataSearchIdKey],t)),u=this._getParentKeyForListItem({listUrlParts:r,itemUrl:c,requestKeyParts:o}),f={key:l,type:j.e.Folder,newWOPIDocumentEnabled:G.optional(i.NewWOPIDocumentEnabled)};if(u&&(f.parentKey=u),i.ListData){if(n=i.ListData.FolderId,"Sharepoint.DocumentSet"===i.ListData.CurrentFolderProgId){f.isDocSet=!0;var p=i.FolderContentTypeId,m=void 0,_=void 0;if(i.AvailableContentTypes)for(var h=0,b=i.AvailableContentTypes;h<b.length;h++){var g=b[h],v=g.contentTypeId;if(v&&0===v.indexOf("0x0120D520")){if(ae){f.contentTypeId=v,a=g.displayName;break}if(p===v){f.contentTypeId=v,a=g.displayName;break}v&&0===v.indexOf("0x0120D520")&&(m||(m=v,_=g.displayName))}ae||f.contentTypeId||(f.contentTypeId=m,a=_)}}if(i.ListData.CurrentFolderSpItemUrl){var y=this._vroomUrlHelper.getUrlParts(i.ListData.CurrentFolderSpItemUrl);f.itemId=G.optional(y.itemId),f.graph={itemId:G.optional(y.itemId),driveId:G.optional(y.driveId)}}}if(a&&f.contentTypeId?f.properties={ID:G.optional(n),ContentType:a,ContentTypeId:f.contentTypeId}:f.properties={ID:G.optional(n)},!this._isListRoot({itemUrl:c,listUrlParts:r})){var S=c.split("/").slice(-1)[0];f.name=S,f.displayName=S}return s.update([new H.e(l).succeed({item:f})]),{parentItemUrls:this._getParentItemUrls({listUrlParts:r,itemUrl:c})}},e.prototype._processWeb=function(e){var t,n=e.list,a=e.requestKeyParts,i=e.observer,r=n.HttpRoot,o=n.SiteTitle,s=n.WebUrl||r&&J.a(decodeURIComponent(r)),c=this._itemUrlHelper.getUrlParts({path:s,webUrl:s}),d=this._urlDataSource.getKey(((t={})[T.t.idParamKey]=c.normalizedItemUrl,t[T.t.queryTypeParamKey]=U.e.DocumentLibraries,t[T.t.typeFiltersKey]=a[T.t.typeFiltersKey],t)),l={serverRelativeUrl:s},u={key:d,type:j.e.Folder,subsite:l},f=!ne&&e.pageContext||this._pageContext.webAbsoluteUrl===s&&this._pageContext;f&&(u.name=o,u.displayName=o,l.webTemplateId=Number(f.webTemplate),l.serverRelativeUrl=f.webAbsoluteUrl,l.id=f.webId,l.siteCollectionId=f.siteId,l.title=f.webTitle,l.icon=f.webLogoUrl),i.update([new H.e(d).succeed({item:u})])},e.prototype._processList=function(e){var t,n,a,i,r,o,s=e.list,c=e.listUrlParts,d=e.requestKeyParts,l=e.observer,u=s.ListTitle,f=s.HttpRoot,p=s.ListUrl,m=s.listUrlDir,_=p||m&&decodeURIComponent(m),h=this._urlDataSource.getKey(((t={})[T.t.idParamKey]=c.serverRelativeItemUrl,t[T.t.listUrlKey]=c.normalizedListUrl,t[T.t.queryTypeParamKey]=d[T.t.queryTypeParamKey],t[T.t.queryParamKey]=d[T.t.queryParamKey],t[T.t.typeFiltersKey]=d[T.t.typeFiltersKey],t[T.t.metadataSearchIdKey]=d[T.t.metadataSearchIdKey],t)),b=s.AllowCreateFolder,g=s.EnableMinorVersions,v=s.verEnabled,y=s.AllowGridMode,S=s.DisableGridEditing,D=s.ListTemplateType,I=s.BasePermissions,x=void 0===I?{}:I,O=x.ManageLists,w=void 0===O?void 0:O,E=x.ManagePersonalViews,A=void 0===E?void 0:E,L=x.OpenItems,k=void 0===L?void 0:L,M=x.UseClientIntegration,P=void 0===M?void 0:M,F=s.ListSchema,R=void 0===F?{}:F,N=R.DefaultItemOpen,B=void 0===N?void 0:N,V=R[".driveAccessTokenV21"],K=void 0===V?void 0:V,W=R[".driveAccessToken"],q=void 0===W?void 0:W,Q=R[".driveUrl"],Y=void 0===Q?void 0:Q,Z=R[".driveUrlV21"],ee=void 0===Z?void 0:Z,te=s.ExcludeFromOfflineClient,ae=s.WebExcludeFromOfflineClient,re=s.listBaseType,oe=q,se=K,ce=Y,de=ee,le=!ne&&e.pageContext||_===this._pageContext.listUrl&&this._pageContext,ue=null==le?void 0:le.driveInfo;s.isFromServiceWorkerCache&&ue&&(ue[".driveAccessToken"]&&(oe=ue[".driveAccessToken"]),ue[".driveAccessTokenV21"]&&(se=ue[".driveAccessTokenV21"]),ue[".driveUrl"]&&(ce=ue[".driveUrl"]),ue[".driveUrlV21"]&&(de=ue[".driveUrlV21"])),oe&&(a={accessToken:(r=Object(X.e)(oe)).access_token,proofToken:r.prooftoken,tokenUrl:ce}),se&&(i={accessToken:(r=Object(X.e)(se)).access_token,proofToken:r.prooftoken,tokenUrl:de});var fe=s.WebUrl||f&&J.a(decodeURIComponent(f));if(fe){var pe=this._itemUrlHelper.getUrlParts({path:fe,webUrl:fe});o=this._urlDataSource.getKey(((n={})[T.t.idParamKey]=pe.normalizedItemUrl,n[T.t.queryTypeParamKey]=U.e.DocumentLibraries,n[T.t.typeFiltersKey]=d[T.t.typeFiltersKey],n))}var me="string"==typeof B?"0"===B:void 0;me&&(ie||(C.e.logData({name:"List.openInClient"}),ie=!0));var _e=ce&&this._vroomUrlHelper.getUrlParts(ce)||void 0;a&&Object($.e)({authToken:a.accessToken,proofToken:a.proofToken})&&(a=void 0),i&&Object($.e)({authToken:i.accessToken,proofToken:i.proofToken})&&(i=void 0);var he="number"==typeof re?Object(z.n)(String(re)):void 0;return l.update([new H.e(h).succeed({item:{key:h,parentKey:G.optional(o),itemId:G.backup("root"),graph:{itemId:G.backup("root"),driveId:G.optional((null==_e?void 0:_e.driveId)||void 0),sessionToken:G.optional(a),sessionTokenV21:G.optional(i)},type:j.e.Folder,name:G.optional(u),displayName:G.optional(u),isRootFolder:!0,isDropEnabled:!0,folder:{},newWOPIDocumentEnabled:G.optional(s.rootFolder?void 0:s.NewWOPIDocumentEnabled),list:{id:G.optional(s.listName),allowGridMode:"boolean"==typeof y?y:G.backup(!0),allowCreateFolder:G.optional(b),disableCommenting:"boolean"==typeof s.DisableCommenting&&s.DisableCommenting,disableGridEditing:"boolean"==typeof S?S:G.backup(!1),enableMinorVersions:G.optional(g),enableVersions:G.optional(v),templateType:G.optional("string"==typeof D?Number(D):void 0),isDocumentLibrary:G.optional(he),isPromotedLinks:G.optional("string"==typeof D?Object(z.i)(D):void 0),isForceCheckout:G.optional(s.isForceCheckout),isModerated:G.optional(s.isModerated),newWOPIDocumentEnabled:G.optional(s.NewWOPIDocumentEnabled),newWOPIDocumentTypes:G.optional(s.NewWOPIDocumentTypes),permissions:{manageLists:G.optional(w),managePersonalViews:G.optional(A),openItems:G.optional(k),useClientIntegration:G.optional(P)},openInClient:G.optional(me),excludeFromOfflineClient:G.optional("boolean"==typeof te||"boolean"==typeof ae?te||ae:void 0),contentTypesEnabled:G.optional(s.ContentTypesEnabled),metadataNavFeatureEnabled:G.optional(s.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:G.optional(s.canUserCreateMicrosoftForm),itemCount:G.optional(s.ListSchema&&s.ListSchema.ItemCount),rowLimit:G.optional(s.ListData.RowLimit),listUrlDir:_,createdFromExcel:G.optional(s.CreatedFromExcel),createdFromExisting:G.optional(s.CreatedFromExisting)},properties:{commandsSupported:G.optional(s.CanShareLinkForNewDocument&&{canShareLinkForNewDocument:"1"})}}})]),{listRootItemKey:h}},e.prototype._processParentItem=function(e){var t,n=e.itemUrl,a=e.listUrlParts,i=e.parentInfo,r=e.requestKeyParts,o=e.observer,s=this._itemUrlHelper.getUrlParts({path:n,listUrl:a.fullListUrl}),c=this._urlDataSource.getKey(((t={})[T.t.idParamKey]=s.serverRelativeItemUrl,t[T.t.listUrlKey]=s.normalizedListUrl,t[T.t.queryTypeParamKey]=r[T.t.queryTypeParamKey],t[T.t.queryParamKey]=r[T.t.queryParamKey],t[T.t.typeFiltersKey]=r[T.t.typeFiltersKey],t[T.t.metadataSearchIdKey]=r[T.t.metadataSearchIdKey],t)),d={key:c,parentKey:this._getParentKeyForListItem({listUrlParts:a,itemUrl:n,requestKeyParts:r}),queryType:this._urlDataSource.getQueryType(r)};if(this._isListRoot({itemUrl:n,listUrlParts:a}))d.list={};else{var l=J.n(n);d.name=l,d.displayName=l,d.type=j.e.Folder,d.isDropEnabled=!0,d.folder={},i&&i[n]&&(d.permissions=i[n])}o.update([new H.e(c).succeed({item:d})])},e.prototype._getParentKeyForListItem=function(e){var t,n,a=e.listUrlParts,i=e.itemUrl,r=e.requestKeyParts;if(a.serverRelativeListUrl!==i){if(!ee.e.isActivated("556c889b-eaaf-4e07-a746-6f7c7eee8553","8/18/2021","Show a more user-friendly error when the item does not have a FileRef field")&&!i)throw new Error(te.e);var o=i.split("/").slice(0,-1).join("/"),s=this._itemUrlHelper.getUrlParts({path:o,listUrl:a.fullListUrl});n=this._urlDataSource.getKey(((t={})[T.t.idParamKey]=s.serverRelativeItemUrl,t[T.t.listUrlKey]=s.normalizedListUrl,t[T.t.queryTypeParamKey]=r[T.t.queryTypeParamKey],t[T.t.queryParamKey]=r[T.t.queryParamKey],t[T.t.typeFiltersKey]=r[T.t.typeFiltersKey],t[T.t.metadataSearchIdKey]=r[T.t.metadataSearchIdKey],t))}return n},e.prototype._getParentItemUrls=function(e){var t=e.listUrlParts,n=e.itemUrl,a=[],i=t.serverRelativeListUrl;if(0===n.indexOf(i))for(var r="",o=0,s=n.substring(i.length).split("/").slice(1,-1);o<s.length;o++){var c=s[o];r+="/".concat(c);var d="".concat(i).concat(r);a.push(d)}return a},e.prototype._isListRoot=function(e){var t=e.itemUrl;return e.listUrlParts.serverRelativeListUrl===t},e.prototype._isFolder=function(e){var t;if("1"===e.FSObjType){var n=e["File_x0020_Type.mapapp"],a=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];t=!(n&&"onenote"===n.substring(0,7)||a&&-1!==a.indexOf("onenote"))}else t=!1;return t},e.dependencies={urlDataSource:F.s,pageContext:N.t,itemUrlHelper:K.r,vroomUrlHelper:Y,resources:Z.i},e}(),oe=Object(P.r)("ListItemResultProcessor",re),se=n(743),ce=n(543),de=ee.e.isActivated("0734D9E7-806F-4FD2-85CF-CF1F9A7E0B27","6/9/2021","Add noRedirect to auth token request"),le=function(){function e(e,t){void 0===e&&(e={}),this._itemTaskObserverType=t.itemTaskObserverType,this._itemUrlHelper=t.itemUrlHelper,this._listItemResultProcessor=t.listItemResultProcessor,this._pageContext=t.pageContext,this._urlDataSourceLite=t.urlDataSourceLite}return e.prototype.getAuthToken=function(e){var t,n,o=this;if(!this._pageContext.isSPO)return i.t.reject(new Error("getAuthToken is not supported OnPrem"));var s=new M({pageContext:this._pageContext}),c=e&&e.key||this._urlDataSourceLite.getRootItemKey(),l=void 0;if(Object(ce.A)(ce.L)&&(null===(n=null===(t=this._pageContext)||void 0===t?void 0:t.serverRequestPath)||void 0===n?void 0:n.indexOf("stream.aspx"))>=0){var u=this._urlDataSourceLite.getCurrentItemKey(),m=this._itemUrlHelper.getItemUrlParts(u);l=this._itemUrlHelper.getUrlParts({path:m.serverRelativeItemUrl,mayInferListUrl:!0})}else m=this._itemUrlHelper.getItemUrlParts(c),l=this._itemUrlHelper.getUrlParts({path:m.serverRelativeListUrl,listUrl:m.fullListUrl});var _=function(e){var t,n=e.sortField,i=e.itemIds,r=e.itemRefs,o=e.isAscending,s=e.pageSize,c=e.fetchNextGroup,l=e.lastGroup,u=e.recurseInFolders,m=e.typeFilter,_=void 0===m?{filters:[]}:m,h=e.fieldNames,b=void 0===h?[]:h,g=e.groupBy,I=void 0===g?[]:g,x=e.userIsAnonymous,C=void 0!==x&&x,O=e.requestMetaInfo,w=void 0!==O&&O,E=e.requestCommentFlags,A=void 0!==E&&E,L=e.fileTypeIconMap,k="",M="",P="",T="",U=!1;if(s||(s=1),I&&I.length>0){var F=I.map(function(e){return'<FieldRef Name="'.concat(e,'"/>')}).join("");k='<GroupBy Collapse="FALSE">'.concat(F,"</GroupBy>")}if(c&&(t=function(e){var t=e.fieldSchema.Name,n=!d.t.isActivated("69f4bf91-aa36-4e53-9659-8d083662b4ab","2/22/2021","Use ResultType as type if possible")&&!!e.fieldSchema.ResultType&&e.fieldSchema.ResultType||e.fieldSchema.Type,a=e.fieldSchema.Ascending&&"false"===e.fieldSchema.Ascending.toLowerCase(),i=a?"Lt":"Gt",r=e.groupingId;if("DateTime"===n){if("(null)"===r&&!a)return"<IsNotNull>"+'<FieldRef Name="'.concat(t,'" />')+"</IsNotNull>";if(e.fieldFilterByValue)r=e.fieldFilterByValue;else if("(null)"!==r)try{var o=new Date(r);r="".concat(o.getUTCFullYear(),"-").concat(o.getUTCMonth()+1,"-").concat(o.getUTCDate(),"T00:00:00Z")}catch(e){}}else"Boolean"===n&&""===r&&(r="-1");var s="<".concat(i,">")+'<FieldRef Name="'.concat(t,'" />')+'<Value Type="'.concat(n,'"><![CDATA[').concat(r,"]]></Value>")+"</".concat(i,">");return!a||"(null)"===r&&""===e.fieldFilterByValue||(s='<Or><IsNull><FieldRef Name="'.concat(t,'" /></IsNull>').concat(s,"</Or>")),s}(l)),i&&i.length>0||r&&r.length>0){var H=[],R=[];if(i)for(var N=0,B=i;N<B.length;N++){var j=B[N];isNaN(Number(j))?H.push(j):R.push(j)}t=S([D("ID",1===R.length?"Number":"Counter",R),D("UniqueId","Guid",H),D("FileRef","Text",r&&r.map(function(e){return"<![CDATA[".concat(e,"]]>")}))]),u&&(T='Scope="RecursiveAll"')}else P=n?'<OrderBy><FieldRef Name="'.concat(n,'" Ascending="').concat(o,'"></FieldRef></OrderBy>'):"",U=!0;return _.filters.length&&(t=function(e,t){void 0===t&&(t={});for(var n=t.fileTypeIconMap,i=[],r=[],o=[],s=[],c=0,d=0,l=e.filters;d<l.length;d++){var u=l[d];if("string"==typeof u){var p=u,m=!1;"!"===p[0]&&(p=p.slice(1),m=!0);var _="."===p[0],h=_?p.slice(1):p;if(_){var b='<Value Type="Text">${extType}</Value>'.replace("${extType}",h);m?s.push(b):o.push(b)}else switch(f.e[h]){case f.e.photo:n&&(m?r.push(D("File_x0020_Type","String",n.photo.extensions,!0)):i.push(D("File_x0020_Type","String",n.photo.extensions,!1)));break;case f.e.video:n&&(m?r.push(D("File_x0020_Type","String",n.video.extensions,!0)):i.push(D("File_x0020_Type","String",n.video.extensions,!1)));break;case f.e.audio:n&&(m?r.push(D("File_x0020_Type","String",n.audio.extensions,!0)):i.push(D("File_x0020_Type","String",n.audio.extensions,!1)));break;case f.e.folder:c+=m?-1:1;break;case f.e.onenote:m?r.push(y):i.push(v)}}else switch(u){case f.e.listItem:case f.e.file:return"";case f.e.photo:case f.e["!photo"]:n&&(u<0?r.push(D("File_x0020_Type","String",n.photo.extensions,!0)):i.push(D("File_x0020_Type","String",n.photo.extensions,!1)));break;case f.e.video:case f.e["!video"]:n&&(u<0?r.push(D("File_x0020_Type","String",n.video.extensions,!0)):i.push(D("File_x0020_Type","String",n.video.extensions,!1)));break;case f.e.audio:case f.e["!audio"]:n&&(u<0?r.push(D("File_x0020_Type","String",n.audio.extensions,!0)):i.push(D("File_x0020_Type","String",n.audio.extensions,!1)));break;case f.e.folder:case f.e["!folder"]:c+=u<0?-1:1;break;case f.e.onenote:case f.e["!onenote"]:u<0?r.push(y):i.push(v)}}return o.length>0&&i.push(D("File_x0020_Type","",o,!1)),s.length>0&&r.push(D("File_x0020_Type","",s,!0)),S([c>0?'<Or><And><Eq><FieldRef Name="FSObjType" /><Value Type="Text">1</Value></Eq><Eq><FieldRef Name="SortBehavior" /><Value Type="Text">1</Value></Eq></And><Eq><FieldRef Name="ProgId" /><Value Type="Text">AddToOneDrive.MountPoint</Value></Eq></Or>':"",(g=Object(a.o)(Object(a.o)([S(i)],r,!0),[c<0?'<And><Neq><FieldRef Name="FSObjType" /><Value Type="Text">1</Value></Neq><Neq><FieldRef Name="ProgId" /><Value Type="Text">AddToOneDrive.MountPoint</Value></Neq></And>':""],!1),g.reduce(function(e,t){return e&&t?"<And>".concat(e).concat(t,"</And>"):t||e},""))]);var g}(_,{fileTypeIconMap:L})),t&&(M="<Where>".concat(t,"</Where>")),function(e){var t=e.viewParams,n=e.query,i=e.pageSize,r=void 0===i?30:i,o=e.fieldNames,s=void 0===o?[]:o,c=e.userIsAnonymous,d=void 0!==c&&c,l=e.requestMetaInfo,u=void 0!==l&&l,f=e.requestCommentFlags,m=void 0!==f&&f;if(e.includeFields){if(s=Object(a.o)(["_ip_UnifiedCompliancePolicyUIAction","ItemChildCount","FolderChildCount","SMTotalFileCount","SMTotalSize"],s,!0),u){var _=["MediaServiceFastMetadata","MediaServiceOCR"];p.e.isFeatureEnabled({ODB:1208})&&_.push("MediaServiceTranscript"),s=Object(a.o)(Object(a.o)([],_,!0),s,!0)}m&&(s=Object(a.o)(["_CommentFlags"],s,!0)),d||(s=Object(a.o)(["SharedWith"],s,!0)),s=Object(a.o)(["DocIcon","LinkFilename","Modified","Editor","FileSizeDisplay"],s,!0)}s=function(e){var t;if(e){t=[];var n=void 0;n={};for(var a=0,i=e;a<i.length;a++){var r=i[a];n[r]||(n[r]=!0,t.push(r))}}return t}(s);var h="";return s.length&&(h="<ViewFields>".concat(s.map(function(e){return'<FieldRef Name="'.concat(e,'"/>')}).join(""),"</ViewFields>")),"<View ".concat(t,">")+"<Query>".concat(n,"</Query>")+h+'<RowLimit Paged="TRUE">'.concat(r,"</RowLimit>")+"</View>"}({viewParams:T,query:P+k+M,pageSize:s,includeFields:U,fieldNames:b,userIsAnonymous:C,requestMetaInfo:w,requestCommentFlags:A})}({pageSize:1}),h=Object(a.e)({parentKey:c,postDataContext:{viewXml:_,needsSchema:!0,isListDataRenderOptionChangeFeatureEnabled:!0},skipServiceWorkerCache:!0},de?{}:{noRedirect:!0}),b={urlParts:l},g={qosEvent:new r.e({name:"FetchAuthToken"}),qosName:"AuthToken.GetData"};return s.getItem(h,b,g).then(function(e){var t=new o._itemTaskObserverType;if(o._listItemResultProcessor.processResponse({response:Object(a.e)(Object(a.e)({},e),{ListData:Object(a.e)(Object(a.e)({},e.ListData),{Row:[]})}),pageContext:void 0,requestKey:c,observer:t}),t.flush(),e&&e.ListSchema)return{data:e.ListSchema,allowCookies:!1}})},e.dependencies={itemTaskObserverType:se.resourceKey,itemUrlHelper:K.r,listItemResultProcessor:oe,pageContext:N.t,urlDataSourceLite:F.c},e}(),ue=Object(P.r)("KnockoutAuthTokenDataSource",le)}}]);