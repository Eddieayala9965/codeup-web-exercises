 if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas-gov.us/js-bootstrap.js?saasId=11394&type=WORKER&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas-gov.us/js-bootstrap.js?saasId=11394&type=WINDOW&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[666,482],{2236:function(e,t,n){"use strict";n.d(t,"e",function(){return i;}),n.d(t,"t",function(){return o;});var a=n(18),i=a.n.durationValue2,r={root:"ms-Modal",main:"ms-Dialog-main",scrollableContent:"ms-Modal-scrollableContent",isOpen:"is-open",layer:"ms-Modal-Layer"},o=function(e){var t,n=e.className,o=e.containerClassName,s=e.scrollableContentClassName,c=e.isOpen,d=e.isVisible,l=e.hasBeenOpened,u=e.modalRectangleTop,f=e.theme,p=e.topOffsetFixed,m=e.isModeless,_=e.layerClassName,h=e.isDefaultDragHandle,b=e.windowInnerHeight,g=f.palette,v=f.effects,y=f.fonts,S=Object(a.C)(r,f);return{root:[S.root,y.medium,{backgroundColor:"transparent",position:"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity ".concat(i)},p&&"number"==typeof u&&l&&{alignItems:"flex-start"},c&&S.isOpen,d&&{opacity:1},d&&!m&&{pointerEvents:"auto"},n],main:[S.main,{boxShadow:v.elevation64,borderRadius:v.roundedCorner2,backgroundColor:g.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid transparent",maxHeight:"calc(100% - 32px)",maxWidth:"calc(100% - 32px)",minHeight:"176px",minWidth:"288px",overflowY:"auto",zIndex:m?a.v.Layer:void 0},m&&{pointerEvents:"auto"},p&&"number"==typeof u&&l&&{top:u},h&&{cursor:"move"},o],scrollableContent:[S.scrollableContent,{overflowY:"auto",flexGrow:1,maxHeight:"100vh",selectors:(t={},t["@supports (-webkit-overflow-scrolling: touch)"]={maxHeight:b},t)},s],layer:m&&[_,S.layer,{pointerEvents:"none"}],keyboardMoveIconContainer:{position:"absolute",display:"flex",justifyContent:"center",width:"100%",padding:"3px 0px"},keyboardMoveIcon:{fontSize:y.xLargePlus.fontSize,width:"24px"}};};},2260:function(e,t,n){"use strict";n.d(t,"e",function(){return R;});var a=n(0),i=n("react-lib"),r=n(593),o=n(1917),s=n(208),c=n(933),d=n(143),l=n(413),u=n(83),f=n(2204),p=n(2236),m=n(2314),_=n(2211),h=n(2198),b=n(2196),g=n(351),v=n(167),y=n(442),S=n(128),D=n(18),I=Object(S.t)(function(e,t){return{root:Object(D.H)(e,t&&{touchAction:"none",selectors:{"& *":{userSelect:"none"}}})};}),x=n(1338),C={start:"touchstart",move:"touchmove",stop:"touchend"},O={start:"mousedown",move:"mousemove",stop:"mouseup"},w=(function(e){function t(t){var n=e.call(this,t)||this;return n._currentEventType=O,n._events=[],n._onMouseDown=function(e){var t=i.Children.only(n.props.children).props.onMouseDown;return t&&t(e),n._currentEventType=O,n._onDragStart(e);},n._onMouseUp=function(e){var t=i.Children.only(n.props.children).props.onMouseUp;return t&&t(e),n._currentEventType=O,n._onDragStop(e);},n._onTouchStart=function(e){var t=i.Children.only(n.props.children).props.onTouchStart;return t&&t(e),n._currentEventType=C,n._onDragStart(e);},n._onTouchEnd=function(e){var t=i.Children.only(n.props.children).props.onTouchEnd;t&&t(e),n._currentEventType=C,n._onDragStop(e);},n._onDragStart=function(e){if("number"==typeof e.button&&0!==e.button)return!1;if(!(n.props.handleSelector&&!n._matchesSelector(e.target,n.props.handleSelector)||n.props.preventDragSelector&&n._matchesSelector(e.target,n.props.preventDragSelector))){n._touchId=n._getTouchId(e);var t=n._getControlPosition(e);if(void 0!==t){var a=n._createDragDataFromPosition(t);n.props.onStart&&n.props.onStart(e,a),n.setState({isDragging:!0,lastPosition:t}),n._events=[Object(x.e)(document.body,n._currentEventType.move,n._onDrag,!0),Object(x.e)(document.body,n._currentEventType.stop,n._onDragStop,!0)];}}},n._onDrag=function(e){"touchmove"===e.type&&e.preventDefault();var t=n._getControlPosition(e);if(t){var a=n._createUpdatedDragData(n._createDragDataFromPosition(t)),i=a.position;n.props.onDragChange&&n.props.onDragChange(e,a),n.setState({position:i,lastPosition:t});}},n._onDragStop=function(e){if(n.state.isDragging){var t=n._getControlPosition(e);if(t){var a=n._createDragDataFromPosition(t);n.setState({isDragging:!1,lastPosition:void 0}),n.props.onStop&&n.props.onStop(e,a),n.props.position&&n.setState({position:n.props.position}),n._events.forEach(function(e){return e();});}}},n.state={isDragging:!1,position:n.props.position||{x:0,y:0},lastPosition:void 0},n;}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(e){!this.props.position||e.position&&this.props.position===e.position||this.setState({position:this.props.position});},t.prototype.componentWillUnmount=function(){this._events.forEach(function(e){return e();});},t.prototype.render=function(){var e=i.Children.only(this.props.children),t=e.props,n=this.props.position,r=this.state,o=r.position,s=r.isDragging,c=o.x,d=o.y;return n&&!s&&(c=n.x,d=n.y),i.cloneElement(e,{style:Object(a.__assign)(Object(a.__assign)({},t.style),{transform:"translate(".concat(c,"px, ").concat(d,"px)")}),className:I(t.className,this.state.isDragging).root,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onTouchStart:this._onTouchStart,onTouchEnd:this._onTouchEnd});},t.prototype._getControlPosition=function(e){var t=this._getActiveTouch(e);if(void 0===this._touchId||t){var n=t||e;return{x:n.clientX,y:n.clientY};}},t.prototype._getActiveTouch=function(e){return e.targetTouches&&this._findTouchInTouchList(e.targetTouches)||e.changedTouches&&this._findTouchInTouchList(e.changedTouches);},t.prototype._getTouchId=function(e){var t=e.targetTouches&&e.targetTouches[0]||e.changedTouches&&e.changedTouches[0];if(t)return t.identifier;},t.prototype._matchesSelector=function(e,t){if(!e||e===document.body)return!1;var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return!!n&&(n.call(e,t)||this._matchesSelector(e.parentElement,t));},t.prototype._findTouchInTouchList=function(e){if(void 0!==this._touchId)for(var t=0;t<e.length;t++)if(__WRAPPED_get(e,t).identifier===this._touchId)return __WRAPPED_get(e,t);},t.prototype._createDragDataFromPosition=function(e){var t=this.state.lastPosition;return void 0===t?{delta:{x:0,y:0},lastPosition:e,position:e}:{delta:{x:e.x-t.x,y:e.y-t.y},lastPosition:t,position:e};},t.prototype._createUpdatedDragData=function(e){var t=this.state.position;return{position:{x:t.x+e.delta.x,y:t.y+e.delta.y},delta:e.delta,lastPosition:t};},t;}(i.Component)),E=n(939),A=n(1914),L=n(1992),k=n(1999),M=n(2313),P=n(529),T=n(1997),U={x:0,y:0},F={isOpen:!1,isDarkOverlay:!0,className:"",containerClassName:"",enableAriaHiddenSiblings:!0},H=Object(r.e)(),R=i.forwardRef(function(e,t){var n,r,S,D,I,x=Object(o.e)(F,e),C=x.allowTouchBodyScroll,O=x.className,R=x.children,N=x.containerClassName,B=x.scrollableContentClassName,j=x.elementToFocusOnDismiss,V=x.firstFocusableSelector,z=x.focusTrapZoneProps,G=x.forceFocusInsideTrap,K=x.disableRestoreFocus,W=void 0===K?x.ignoreExternalFocusing:K,q=x.isBlocking,Q=x.isAlert,Y=x.isClickableOutsideFocusTrap,J=x.isDarkOverlay,X=x.onDismiss,Z=x.layerProps,$=x.overlay,ee=x.isOpen,te=x.titleAriaId,ne=x.styles,ae=x.subtitleAriaId,ie=x.theme,re=x.topOffsetFixed,oe=x.responsiveMode,se=x.onLayerDidMount,ce=x.isModeless,de=x.dragOptions,le=x.onDismissed,ue=x.enableAriaHiddenSiblings,fe=x.popupProps,pe=i.useRef(null),me=i.useRef(null),_e=Object(A.e)(me,null==z?void 0:z.componentRef),he=i.useRef(null),be=Object(A.e)(pe,t),ge=Object(b.e)(be),ve=Object(L.e)("ModalFocusTrapZone",null==z?void 0:z.id),ye=Object(E.n)(),Se=Object(k.e)(),De=Se.setTimeout,Ie=Se.clearTimeout,xe=i.useState(ee),Ce=xe[0],Oe=xe[1],we=i.useState(ee),Ee=we[0],Ae=we[1],Le=i.useState(U),ke=Le[0],Me=Le[1],Pe=i.useState(),Te=Pe[0],Ue=Pe[1],Fe=Object(M.e)(!1),He=Fe[0],Re=Fe[1],Ne=Re.toggle,Be=Re.setFalse,je=Object(P.e)(function(){return{onModalCloseTimer:0,allowTouchBodyScroll:C,scrollableContent:null,lastSetCoordinates:U,events:new s.e({})};}),Ve=(de||{}).keepInBounds,ze=null!=Q?Q:q&&!ce,Ge=void 0===Z?"":Z.className,Ke=H(ne,{theme:ie,className:O,containerClassName:N,scrollableContentClassName:B,isOpen:ee,isVisible:Ee,hasBeenOpened:je.hasBeenOpened,modalRectangleTop:Te,topOffsetFixed:re,isModeless:ce,layerClassName:Ge,windowInnerHeight:null==ye?void 0:ye.innerHeight,isDefaultDragHandle:de&&!de.dragHandleSelector}),We=Object(a.__assign)(Object(a.__assign)({eventBubblingEnabled:!1},Z),{onLayerDidMount:Z&&Z.onLayerDidMount?Z.onLayerDidMount:se,insertFirst:(null==Z?void 0:Z.insertFirst)||ce,className:Ke.layer}),qe=i.useCallback(function(e){e?je.allowTouchBodyScroll?Object(c.e)(e,je.events):Object(c.t)(e,je.events):je.events.off(je.scrollableContent),je.scrollableContent=e;},[je]),Qe=function(){var e=he.current,t=null==e?void 0:e.getBoundingClientRect();t&&(re&&Ue(t.top),Ve&&(je.minPosition={x:-t.left,y:-t.top},je.maxPosition={x:t.left,y:t.top}));},Ye=i.useCallback(function(e,t){var n=je.minPosition,a=je.maxPosition;return Ve&&n&&a&&(t=Math.max(__WRAPPED_get(n,e),t),t=Math.min(__WRAPPED_get(a,e),t)),t;},[Ve,je]),Je=function(){var e;je.lastSetCoordinates=U,Be(),je.isInKeyboardMoveMode=!1,Oe(!1),Me(U),null===(e=je.disposeOnKeyUp)||void 0===e||e.call(je),null==le||le();},Xe=i.useCallback(function(){Be(),je.isInKeyboardMoveMode=!1;},[je,Be]),Ze=i.useCallback(function(e,t){Me(function(e){return{x:Ye("x",e.x+t.delta.x),y:Ye("y",e.y+t.delta.y)};});},[Ye]),$e=i.useCallback(function(){me.current&&me.current.focus();},[]);i.useEffect(function(){var e;Ie(je.onModalCloseTimer),ee&&(requestAnimationFrame(function(){return De(Qe,0);}),Oe(!0),de&&(e=function(e){e.altKey&&e.ctrlKey&&e.keyCode===d.e.space&&Object(l.e)(je.scrollableContent,e.target)&&(Ne(),e.preventDefault(),e.stopPropagation());},je.disposeOnKeyUp||(je.events.on(ye,"keyup",e,!0),je.disposeOnKeyUp=function(){je.events.off(ye,"keyup",e,!0),je.disposeOnKeyUp=void 0;})),je.hasBeenOpened=!0,Ae(!0)),!ee&&Ce&&(je.onModalCloseTimer=De(Je,1e3*parseFloat(p.e)),Ae(!1));},[Ce,ee]),Object(T.e)(function(){je.events.dispose();}),(function(e,t){i.useImperativeHandle(e.componentRef,function(){return{focus:function(){t.current&&t.current.focus();}};},[t]);}(x,me));var et=i.createElement(f.e,Object(a.__assign)({},z,{id:ve,ref:he,componentRef:_e,className:Object(u.e)(Ke.main,null==z?void 0:z.className),elementToFocusOnDismiss:null!==(n=null==z?void 0:z.elementToFocusOnDismiss)&&void 0!==n?n:j,isClickableOutsideFocusTrap:null!==(r=null==z?void 0:z.isClickableOutsideFocusTrap)&&void 0!==r?r:ce||Y||!q,disableRestoreFocus:null!==(S=null==z?void 0:z.disableRestoreFocus)&&void 0!==S?S:W,forceFocusInsideTrap:(null!==(D=null==z?void 0:z.forceFocusInsideTrap)&&void 0!==D?D:G)&&!ce,firstFocusableSelector:(null==z?void 0:z.firstFocusableSelector)||V,focusPreviouslyFocusedInnerElement:null===(I=null==z?void 0:z.focusPreviouslyFocusedInnerElement)||void 0===I||I,onBlur:je.isInKeyboardMoveMode?function(e){var t,n;null===(t=null==z?void 0:z.onBlur)||void 0===t||t.call(z,e),je.lastSetCoordinates=U,je.isInKeyboardMoveMode=!1,null===(n=je.disposeOnKeyDown)||void 0===n||n.call(je);}:void 0}),de&&je.isInKeyboardMoveMode&&i.createElement("div",{className:Ke.keyboardMoveIconContainer},de.keyboardMoveIconProps?i.createElement(y.e,Object(a.__assign)({},de.keyboardMoveIconProps)):i.createElement(y.e,{iconName:"move",className:Ke.keyboardMoveIcon})),i.createElement("div",{ref:qe,className:Ke.scrollableContent,"data-is-scrollable":!0},de&&He&&i.createElement(de.menu,{items:[{key:"move",text:de.moveMenuItemText,onClick:function(){var e=function(e){if(e.altKey&&e.ctrlKey&&e.keyCode===d.e.space)return e.preventDefault(),void e.stopPropagation();var t=e.altKey||e.keyCode===d.e.escape;if(He&&t&&Be(),!je.isInKeyboardMoveMode||e.keyCode!==d.e.escape&&e.keyCode!==d.e.enter||(je.isInKeyboardMoveMode=!1,e.preventDefault(),e.stopPropagation()),je.isInKeyboardMoveMode){var n=!0,a=(function(e){var t=10;return e.shiftKey?e.ctrlKey||(t=50):e.ctrlKey&&(t=1),t;}(e));switch(e.keyCode){case d.e.escape:Me(je.lastSetCoordinates);case d.e.enter:je.lastSetCoordinates=U;break;case d.e.up:Me(function(e){return{x:e.x,y:Ye("y",e.y-a)};});break;case d.e.down:Me(function(e){return{x:e.x,y:Ye("y",e.y+a)};});break;case d.e.left:Me(function(e){return{x:Ye("x",e.x-a),y:e.y};});break;case d.e.right:Me(function(e){return{x:Ye("x",e.x+a),y:e.y};});break;default:n=!1;}n&&(e.preventDefault(),e.stopPropagation());}};je.lastSetCoordinates=ke,Be(),je.isInKeyboardMoveMode=!0,je.events.on(ye,"keydown",e,!0),je.disposeOnKeyDown=function(){je.events.off(ye,"keydown",e,!0),je.disposeOnKeyDown=void 0;};}},{key:"close",text:de.closeMenuItemText,onClick:Je}],onDismiss:Be,alignTargetEdge:!0,coverTarget:!0,directionalHint:v.e.topLeftEdge,directionalHintFixed:!0,shouldFocusOnMount:!0,target:je.scrollableContent}),R));return Ce&&ge>=(oe||g.e.small)&&i.createElement(_.e,Object(a.__assign)({ref:be},We),i.createElement(h.e,Object(a.__assign)({role:ze?"alertdialog":"dialog",ariaLabelledBy:te,ariaDescribedBy:ae,onDismiss:X,shouldRestoreFocus:!W,enableAriaHiddenSiblings:ue,"aria-modal":!ce},fe),i.createElement("div",{className:Ke.root,role:ce?void 0:"document"},!ce&&i.createElement(m.e,Object(a.__assign)({"aria-hidden":!0,isDarkThemed:J,onClick:q?void 0:X,allowTouchBodyScroll:C},$)),de?i.createElement(w,{handleSelector:de.dragHandleSelector||"#".concat(ve),preventDragSelector:"button",onStart:Xe,onDragChange:Ze,onStop:$e,position:ke},et):et)))||null;});R.displayName="Modal";},2313:function(e,t,n){"use strict";n.d(t,"e",function(){return r;});var a=n("react-lib"),i=n(529);function r(e){var t=a.useState(e),n=t[0],r=t[1];return[n,{setTrue:Object(i.e)(function(){return function(){r(!0);};}),setFalse:Object(i.e)(function(){return function(){r(!1);};}),toggle:Object(i.e)(function(){return function(){r(function(e){return!e;});};})}];}},2314:function(e,t,n){"use strict";n.d(t,"e",function(){return m;});var a=n(1337),i=n(0),r=n("react-lib"),o=n(593),s=n(1191),c=n(933),d=n(112),l=Object(o.e)(),u=(function(e){function t(t){var n=e.call(this,t)||this;Object(s.e)(n);var a=n.props.allowTouchBodyScroll,i=void 0!==a&&a;return n._allowTouchBodyScroll=i,n;}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){!this._allowTouchBodyScroll&&Object(c.n)();},t.prototype.componentWillUnmount=function(){!this._allowTouchBodyScroll&&Object(c.a)();},t.prototype.render=function(){var e=this.props,t=e.isDarkThemed,n=e.className,a=e.theme,o=e.styles,s=Object(d.s)(this.props,d.r),c=l(o,{theme:a,className:n,isDark:t});return r.createElement("div",Object(i.__assign)({},s,{className:c.root}));},t;}(r.Component)),f=n(18),p={root:"ms-Overlay",rootDark:"ms-Overlay--dark"},m=Object(a.e)(u,function(e){var t,n=e.className,a=e.theme,i=e.isNone,r=e.isDark,o=a.palette,s=Object(f.C)(p,a);return{root:[s.root,a.fonts.medium,{backgroundColor:o.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(t={},__WRAPPED_set(t,f.s,'=',{border:"1px solid WindowText",opacity:0}),t)},i&&{visibility:"hidden"},r&&[s.rootDark,{backgroundColor:o.blackTranslucent40}],n]};},void 0,{scope:"Overlay"});},2342:function(e,t,n){"use strict";n.d(t,"e",function(){return o;});var a=n(1337),i=n(2260),r=n(2236),o=Object(a.e)(i.e,r.t,void 0,{scope:"Modal",fields:["theme","styles","enableAriaHiddenSiblings"]});o.displayName="Modal";},2381:function(e,t,n){"use strict";n.d(t,"e",function(){return i;});var a=n(441),i=(function(){function e(e){this._scope=new a.e(),this._targetMap=new WeakMap(),this._disposableMap=new WeakMap();}return e.prototype.on=function(e,t,n){var a;if(r(e))a=e;else{var i=this._targetMap.get(e);i?a=i:(a=new EventTarget(),this._targetMap.set(e,a));}a.addEventListener(t,n);var o=this._disposableMap.get(e);o||(o=new Map(),this._disposableMap.set(e,o));var s=this._scope.attach({dispose:function(){a.removeEventListener(t,n);}});o.set(t,s);},e.prototype.off=function(e,t,n){var a;if(r(e))a=e;else{var i=this._targetMap.get(e);i&&(a=i);}var o=this._disposableMap.get(e);if(o){var s=o.get(t);s&&(s.dispose(),o.delete(t)),0===o.size&&this._disposableMap.delete(e);}a&&a.removeEventListener(t,n);},e.prototype.dispose=function(){this._scope.dispose();},e;}());function r(e){return!!e.addEventListener;}},2457:function(e,t,n){"use strict";n.d(t,"e",function(){return a;});var a={unsupportedCommand:"unsupportedCommand",handlerError:"handlerError",handlerRejection:"handlerRejection",acknowledgeTimeout:"acknowledgeTimeout",resultTimeout:"resultTimeout",setupTimeout:"setupTimeout",canceled:"canceled",disposed:"disposed"};},2500:function(e,t,n){"use strict";n.d(t,"e",function(){return c;});var a=n(441),i=(function(){function e(e){this._scope=new a.e(),this._timeoutMap=new Map();}return e.prototype.setTimeout=function(e,t){var n=this,a=setTimeout(function(){n._timeoutMap.delete(a),e();},t),i=this._scope.attach({dispose:function(){clearTimeout(a);}});return this._timeoutMap.set(a,i),a;},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose());},e.prototype.dispose=function(){this._scope.dispose();},e;}()),r=n(2381),o=n(2457),s=0,c=(function(){function e(e,t){void 0===t&&(t={});var n=this,s=new Map(),c={onCommand:e.onCommand,onNotification:e.onNotification},d=e.initResources,l=e.initTimeoutMs,u=void 0===l?1e4:l,f=e.ackTimeoutMs,p=void 0===f?1e3:f,m=e.resultTimeoutMs,_=void 0===m?1e4:m,h=t.asyncType,b=void 0===h?i:h,g=t.eventGroupType,v=void 0===g?r.e:g,y=this._scope=new a.e();y.attach(d);var S,D=this._async=y.attach(new b(this)),I=y.attach(new v(this));this._ackTimeoutMs=p,this._resultTimeoutMs=_,this._invokeCommandHandler=function(e){try{var t=c.onCommand&&c.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:o.e.handlerRejection,isExpected:!1,message:"Unknown error"}).code||e.name||o.e.handlerRejection,message:e.message||"".concat(e)},isExpected:!!e.isExpected};}):Promise.resolve({result:"error",error:{code:o.e.unsupportedCommand,message:e.command},isExpected:!0});}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:o.e.handlerError,message:e&&"Name: ".concat(e.name,"; Message: ").concat(e.message||e)}});}},this._invokeNotificationHandler=function(e){try{c.onNotification&&c.onNotification(e);}catch(e){}};var x=this._port=new Promise(function(t,a){y.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=o.e.canceled,a(e);}}),S=D.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(u,"ms"));e.code=o.e.setupTimeout,a(e);},u),e.init(function(e){D.clearTimeout(S),y.attach({dispose:function(){e.close();}}),I.on(e,"message",function(t){var a=t.data;if(a&&"object"==typeof a)return"acknowledge"===a.type?n._onAcknowledge(a):"command"===a.type?n._onCommand(e,a):"notification"===a.type?n._onNotification(a):"result"===a.type?n._onResult(a):void 0;}),e.start(),t(e);},a);});this.ready=x.then(function(){},function(e){return n.dispose(),Promise.reject(e);}),this._signals=s;}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:o.e.canceled,message:"Messenger disposed"}});}),this._signals.clear();},e.prototype.sendCommand=function(e,t){var n=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:o.e.disposed,message:"disposed"}});var a=++s,i=t.timeoutDelayMs,r=void 0===i?this._resultTimeoutMs:i,c=t.acknowledgeTimeoutMs,l=void 0===c?this._ackTimeoutMs:c,u=t.transfer;return this._port.then(function(t){var i=n._async,s=new Promise(function(e){n._signals.set(a,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(d(a,o.e.acknowledgeTimeout));},l),resultTimeout:i.setTimeout(function(){n._onResult(d(a,o.e.resultTimeout));},r),resolve:e});});return __WRAPPED_call(t,'postMessage')({type:"command",id:a,data:e},u||[]),s;});},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){__WRAPPED_call(t,'postMessage')({type:"notification",data:e});});},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout);},e.prototype._onCommand=function(e,t){var n=t.id;__WRAPPED_call(e,'postMessage')({type:"acknowledge",id:n}),this._invokeCommandHandler(t.data).then(function(t){__WRAPPED_call(e,'postMessage')({type:"result",data:t,id:n});}).catch(function(e){});},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data);},e.prototype._onResult=function(e){var t=e.id,n=this._async,a=this._signals,i=a.get(t);i&&(n.clearTimeout(i.acknowledgeTimeout),n.clearTimeout(i.resultTimeout),i.resolve(e.data)),a.delete(t);},e;}());function d(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}};}},2624:function(e,t,n){"use strict";n.d(t,"e",function(){return o;});var a=n(2381),i=n(2500),r=n(441);function o(e,t){void 0===t&&(t={});var n=e.channelId,o=e.onReinitialize,s=e.origin,c=e.receiver,d=void 0===c?window:c,l=e.source,u=e.identifyParent,f=t.eventGroupType,p=void 0===f?a.e:f,m=t.messengerType,_=void 0===m?i.e:m,h=new r.e(),b=h.attach(new p(null));return new _({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var a;if(u&&l){var i=setInterval(function(){var e={type:"identify-parent",channelId:n};__WRAPPED_call(l,'postMessage')(e,s);},100);a=h.attach({dispose:function(){clearInterval(i);}});}var r=!1;b.on(d,"message",function(t){var i=t.data;if(t.origin===s&&(!l||t.source===l)&&i&&"object"==typeof i&&"initialize"===i.type&&i.channelId===n){if(a&&a.dispose(),o){if(r)return o(),void b.dispose();r=!0;}else b.dispose();var c=i.replyTo;__WRAPPED_call(c,'postMessage')({type:"activate"}),e(c);}});},initResources:h,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs});}},3274:function(e,t,n){"use strict";var a;n.r(t),n.d(t,"ShareMessageId",function(){return a;}),(function(e){e.ScriptLoaded="share_scriptsLoaded",e.UIReady="share_uiReady",e.Ready="share_ready",e.Error="share_error",e.Resize="share_resize",e.GrantAccessCompleted="share_grantAccessCompleted",e.Dismiss="share_dismiss",e.ReadyForRecipients="share_readyForRecipients",e.OutlookClicked="share_outlookClicked",e.SendRecipients="atMention_defaultRecipients",e.ManageAccessClicked="share_manageAccessClicked",e.ShareCompleted="share_completed",e.MakeVisible="share_makeVisible",e.Destruct="share_destruct",e.ResetMakeVisible="share_resetMakeVisible",e.InstantLoadReady="share_instantLoadReady",e.ShareContextInformation="share_postContextInformation",e.Started="share_started",e.LinkSettingCompleted="share_linkSettingsCompleted",e.GetToken="share_getToken",e.DocumentInformation="share_documentInformation",e.SharingInfoBarInformation="share_sharingInfoBarInformation",e.SharingStoreReady="share_sharingStoreReady";}(a||(a={})));},3285:function(e,t,n){"use strict";n.d(t,"e",function(){return o;});var a=n(0),i=n(2624),r=n(30),o=(function(e){function t(t){var n=this,r=t.initTimeoutMs,o=void 0===r?4e4:r,s=Object(a.__rest)(t,["initTimeoutMs"]);return(n=e.call(this)||this)._customerPromiseLogger=s.customerPromiseLogger,n._messenger=Object(i.e)(Object(a.__assign)(Object(a.__assign)({},s),{initTimeoutMs:o,identifyParent:!0,onCommand:n._onCommand.bind(n),onNotification:n._onNotificiation.bind(n)})),n;}return Object(a.__extends)(t,e),t.prototype.sendShareDestruct=function(){return this._send({command:"shareCommand",name:"share_destruct"});},t.prototype.sendShareRevisible=function(e){return e.command="shareCommand",this._send(e);},t.prototype.sendSharingContextInformation=function(e){var t={command:"shareCommand",name:"share_postContextInformation",data:e};return this._send(t);},t.prototype.sendNewToken=function(e,t,n){var a={command:"shareCommand",name:"share_newToken"};return e?a.token=e:t&&(a.error=t,a.errorDetails=n),this._send(a);},t.prototype.sendDocumentInformation=function(e){var t={command:"shareCommand",name:"share_documentInformation",data:{documentInformation:e}};return this._send(t);},t.prototype.sendSharingInfoBarInformation=function(e){var t={command:"shareCommand",name:"share_sharingInfoBarInformation",data:{sharingInfoBarInformation:e}};return this._send(t);},t.prototype._send=function(e){var t=this;return this._messenger.sendCommand(e).then(function(e){return!!e;}).catch(function(n){var a;return null===(a=t._customerPromiseLogger)||void 0===a||a.end({resultType:r.t.Failure,errorCode:"SharingHostMessenger - send ".concat(e.name," failed"),extraData:{errorMessage:n.toString()}}),!1;});},t;}((function(){function e(){this._commandHandlers=[],this._notificationHandlers=[];}return Object.defineProperty(e.prototype,"ready",{get:function(){return this._messenger.ready;},enumerable:!1,configurable:!0}),e.prototype.sendCommand=function(e,t){return this._messenger.sendCommand(e,t);},e.prototype.sendNotification=function(e){return this._messenger.sendNotification(e);},e.prototype.addCommandHandler=function(e){var t=this;return this._commandHandlers.push(e),{dispose:function(){var n=t._commandHandlers.indexOf(e);n>-1&&t._commandHandlers.splice(n,1);}};},e.prototype.addNotificationHandler=function(e){var t=this;return this._notificationHandlers.push(e),{dispose:function(){var n=t._notificationHandlers.indexOf(e);n>-1&&t._notificationHandlers.splice(n,1);}};},e.prototype.dispose=function(){this._messenger.dispose();},e.prototype._onCommand=function(e){for(var t=0,n=this._commandHandlers;t<n.length;t++){var a=(0,__WRAPPED_get(n,t))(e);if(a)return a;}},e.prototype._onNotificiation=function(e){for(var t=0,n=this._notificationHandlers;t<n.length;t++)(0,__WRAPPED_get(n,t))(e);},e;}())));},3828:function(e,t,n){"use strict";n.r(t),n.d(t,"ShareDialog",function(){return M;});var a=n(0),i=n("react-lib"),r=n(2342),o=n(2218),s=n(482),c=n(175),d=n(3274),l=n(92);Object(l.n)([{rawString:".sharingContents_15e9006e{display:flex;min-height:130px;min-width:320px;justify-content:center;align-items:center}.sharingContents_15e9006e.fullScreen_15e9006e{width:100%!important;height:100%!important}.sharingContents_15e9006e iframe{border:none;width:0}.errorContainer_15e9006e{padding:20px;max-width:280px;font-size:14px}.errorCode_15e9006e{margin-top:30px;font-size:12px;color:#605e5c;display:block}.spinner_15e9006e{position:absolute;top:50%;left:50%}"}]);var u=n(5051),f=n(158),p=n(145),m=n(3285),_=n(301),h=n(4),b=n(863),g=n(30),v=h.t.isActivated("45a2c5f9-21b8-4775-9e30-4e61d1f67106","02/02/2022","use new share Messenger for cross window communication")||_.e.isFeatureEnabled({ECS:1000619}),y=h.e.isActivated("FBB80417-B626-42B0-9DF6-872E93DD94F6","11/11/2022","ODC Share Fullscreen"),S=h.t.isActivated("c955a4da-3903-4543-b013-65983fc9c20c","02/02/2022","add share_destruct callback, so oneUp can integrate"),D=!h.t.isActivated("a184532b-d640-4bf5-84ad-f7daf50cac5f","07/03/2023","Enable referral telemtry to be use in share link in SWA"),I={sharingInformation:void 0,isSharingDialogLoaded:!1,didSharingHappen:!1,iframeSource:"#",iframeHeight:0,error:void 0,isWindowEventReceived:!1},x=(function(e){function t(t){var n=e.call(this,t)||this;return n._channelId=p.e.generate(),n._setElementRef=function(e){n._iframeRef=e,v||!(null==e?void 0:e.contentWindow)||n._sharingHostMessenger||n.state.isWindowEventReceived||(n._sharingHostMessenger=n._createSharingHostMessenger(e.contentWindow),n.props.setSharingHostMessenger&&n.props.setSharingHostMessenger(n._sharingHostMessenger)),n.props.setElementRef&&n.props.setElementRef(e);},n._onClose=function(){var e=n.state.error;n.state.didSharingHappen?n.props.resolve():e?n.props.reject(e):n.props.reject(new c.e()),n.setState({error:void 0,isSharingDialogLoaded:!1});},n._listenForMessages=function(e){var t;try{t=JSON.parse(e.data);}catch(e){return;}var a=t.name;if(a===d.ShareMessageId.ScriptLoaded)n.setState({isWindowEventReceived:!0});else if(a===d.ShareMessageId.Resize&&t.height)n.setState({iframeHeight:t.height});else if(a===d.ShareMessageId.Ready)n.setState({isSharingDialogLoaded:!0}),n.props.onShareReady();else if(a===d.ShareMessageId.Error)t.error?n.setState({error:t.error}):n.setState({error:{name:"ShareError",message:u.t}});else if(a===d.ShareMessageId.ShareCompleted)n.setState({didSharingHappen:!0});else if(a===d.ShareMessageId.Dismiss)n._sharePrefetchRef&&n._sharePrefetchRef.current&&(n._sharePrefetchRef.current.tabIndex=1,n._sharePrefetchRef.current.focus()),n._onClose(),n.props.onModalClose();else if(a===d.ShareMessageId.ManageAccessClicked){var i=n.props.openManageAccess;i&&(i(),n._onClose());}else a===d.ShareMessageId.GrantAccessCompleted?n.props.onGrantAccessCompleted(t):a===d.ShareMessageId.ReadyForRecipients?n.props.onReadyForRecipients():a===d.ShareMessageId.InstantLoadReady?(n.setState({isSharingDialogLoaded:!0}),n.props.onShareReady()):a===d.ShareMessageId.Destruct&&(S||n.props.onModalDestruct&&n.props.onModalDestruct());},n._getSharingInformation=function(){return Object(a.__awaiter)(n,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.props.getSharingInformation()];case 1:if(!(e=n.sent()))throw new Error("Failed to get sharing information");return this.setState({sharingInformation:e}),[3,3];case 2:return t=n.sent(),this.props.reject(t),[3,3];case 3:return[2];}});});},n._update=function(e){var t,a,i=n.state.sharingInformation;if(i&&!e.sharingInformation){var r=i.authToken,o=i.webAbsoluteUrl,s=i.serverRelativeItemUrl,c=i.listUrl,d=i.cookieAuthIframeUrl,l=i.uniqueId,u=i.listId,p=i.cookieAuthIframeUrlForCrossDomain,m=n.props,_=m.initializeShareFrame,h=m.defaultRecipients,b=m.openManageAccess,g=void 0;switch(n.props.mode){case 2:g="&mode=copy";break;case 5:g="&mode=manageAccess";break;case 7:g="&mode=addPeople";break;case 3:g="&mode=atMention";break;default:g="";}var v="";n.props.fullScreenMode&&(v+="&fullScreenMode=true"),n.props.itemName&&(v+="&itemName=".concat(encodeURIComponent(n.props.itemName)));var S=null===(a=(t=n.props).getNav)||void 0===a?void 0:a.call(t);S&&(v+="&nav=".concat(encodeURIComponent(S))),D&&n.props.optInSendNavIdInShareLink&&(v+="&optInSendNavIdInShareLink=".concat(n.props.optInSendNavIdInShareLink));var I=y?o&&s&&c||l&&u:o&&s&&c||l&&u||i.itemId;if(r&&I&&_){p&&(i.cookieAuthIframeUrlForCrossDomain="".concat(p).concat(g).concat(v));var x=n.props;_({parentElement:n._sharePrefetchRef.current,sharingInformation:i,calloutProps:x,onReady:function(){n.setState({isSharingDialogLoaded:!0});},onDismiss:n.props.onModalClose,onError:function(e){n.setState({error:e});}});}else if(d){var C="".concat(d).concat(g).concat(h&&h.length>0?"&defaultRecipients=".concat(encodeURI(h.join(","))):"","&ma=").concat(b?1:0).concat(v,"&channelId=").concat(n._channelId,"&origin=").concat(encodeURIComponent(new f.e(d).authority));n.setState({iframeSource:C});}else n.props.reject(new Error("Missing sharing information"));}},n.state=Object(a.__assign)(Object(a.__assign)({},I),{iframeHeight:n.props.iframeInitialHeight||0}),n._sharePrefetchRef=i.createRef(),n._shareCustomerPromiseLogger=new b.e({scenario:"SharingIframe.load",perfGoalInMs:3e4}),n;}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillMount=function(){this._getSharingInformation();},t.prototype.componentDidMount=function(){window.addEventListener("message",this._listenForMessages,!1);try{this._update(I);}catch(e){this._shareCustomerPromiseLogger.end({resultType:g.t.Failure,errorCode:"sharingIframeUpdateError",extraData:{clientId:this.props.getClientId(),mode:this.props.mode,errorDetail:e.toString()}});}},t.prototype.componentDidCatch=function(e,t){this._shareCustomerPromiseLogger.end({resultType:g.t.Failure,errorCode:"sharingIframeUpdateError",extraData:{clientId:this.props.getClientId(),mode:this.props.mode,errorInfo:t,errorDetail:e.toString()}});},t.prototype.componentWillUnmount=function(){this._onClose(),window.removeEventListener("message",this._listenForMessages,!1);},t.prototype.componentDidUpdate=function(e,t){this._update(t);},t.prototype.render=function(){var e,t,n,a=this.state,r=a.isSharingDialogLoaded,c=a.iframeSource,d=a.iframeHeight,l=a.error,f=l,p=f&&f.resultCode&&f.resultCode.indexOf("ShareDomainNotReachable")>=0?i.createElement("div",{className:"".concat("errorContainer_15e9006e")},i.createElement("span",null,u.t),i.createElement("span",{className:"".concat("errorCode_15e9006e")},"(",f.resultCode,")")):null,m=2===this.props.mode?120:475,_=null===(t=null===(e=this._sharePrefetchRef.current)||void 0===e?void 0:e.parentElement)||void 0===t?void 0:t.style.maxHeight,h=_?parseInt(_,10):0;return n=d?h?h>d?d:h:d:m,i.createElement("div",{className:"".concat("sharingContents_15e9006e","\n        ").concat(this.props.fullScreenMode?"fullScreen_15e9006e":""),ref:this._sharePrefetchRef,style:{height:"".concat(n,"px")}},!r&&!l&&i.createElement(o.e,{className:"spinner_15e9006e",size:s.e.large}),p,"#"===c?null:i.createElement("iframe",{id:"shareFrame",name:"shareFrame",title:u.e,src:c,style:{visibility:r?"visible":"hidden",width:"100%",height:"100%"},ref:this._setElementRef}));},t.prototype._createSharingHostMessenger=function(e){var t=this;this._clientOrigin=new f.e(this.state.iframeSource).authority;var n=new m.e({origin:this._clientOrigin,channelId:this._channelId,source:e,customerPromiseLogger:this._shareCustomerPromiseLogger});return n.addCommandHandler(function(e){try{switch(e.name){case d.ShareMessageId.ScriptLoaded:break;case d.ShareMessageId.Ready:t.setState({isSharingDialogLoaded:!0}),t._shareCustomerPromiseLogger.end({resultType:g.t.Success}),t.props.onShareReady();break;case d.ShareMessageId.Error:e.error?t.setState({error:e.error}):t.setState({error:{name:"ShareError",message:u.t}});break;case d.ShareMessageId.ShareCompleted:t.setState({didSharingHappen:!0});break;case d.ShareMessageId.Dismiss:t._sharePrefetchRef&&t._sharePrefetchRef.current&&(t._sharePrefetchRef.current.tabIndex=1,t._sharePrefetchRef.current.focus()),t._onClose(),t.props.onModalClose();break;case d.ShareMessageId.ManageAccessClicked:t.props.openManageAccess&&(t.props.openManageAccess(),t._onClose());break;case d.ShareMessageId.GrantAccessCompleted:t.props.onGrantAccessCompleted(e);break;case d.ShareMessageId.ReadyForRecipients:t.props.onReadyForRecipients();break;case d.ShareMessageId.InstantLoadReady:t.setState({isSharingDialogLoaded:!0}),t.props.onShareReady();}return{result:"success"};}catch(e){t._shareCustomerPromiseLogger.end({resultType:g.t.Failure,errorCode:"sharingIframeUpdateError",extraData:{clientId:t.props.getClientId(),mode:t.props.mode,error:e.toString()}});}}),n;},t;}(i.PureComponent)),C=n(218),O=(n(217),C.a.isFeatureEnabled({ODB:60149})),w=null;function E(){w=null;}var A={isOpen:!0,isVisible:!0},L=_.e.isFeatureEnabled({ODB:60577}),k="LoadShareDialog",M=(function(e){function t(t){var n=e.call(this,t)||this;return n.makeVisibleAgain=function(e){n.setState({isVisible:!0}),e?n._sharingHostMessenger?n._sharingHostMessenger.sendShareRevisible(e):n._target&&__WRAPPED_call(n._target,'postMessage')(JSON.stringify(e),"*"):E();},n._setSharingHostMessenger=function(e){n._sharingHostMessenger=e||null,n.props.setSharingHostMessenger&&n.props.setSharingHostMessenger(e);},n._setTopElementRef=function(e){e?(n._iframe=e,n._target=n._iframe.contentWindow):(n._target=null,n._iframe=e),n.props.setElementRef&&n.props.setElementRef(e);},n._onClose=function(){if(O){n.setState({isVisible:!1});var e={name:d.ShareMessageId.Destruct};n._sharingHostMessenger?n._sharingHostMessenger.sendShareDestruct():n._target&&__WRAPPED_call(n._target,'postMessage')(JSON.stringify(e),"*");}else n.setState({isOpen:!1});n._setQosResult(g.t.ExpectedFailure,"Dialog Canceled");},n._onShareReady=function(){n.props.onShareReady&&n.props.onShareReady(),n._setQosResult(g.t.Success,"ShareDialogLoaded");},n._renderFullScreenShareIframe=function(){var e=n.props,t=e.sharingIFrameAs,o=void 0===t?x:t,s=Object(a.__rest)(e,["sharingIFrameAs"]);return s.fullScreenMode=!0,i.createElement(r.e,{className:"sharingModal",onDismiss:n._onClose,isOpen:!!n.state.isOpen,styles:{root:{display:O&&!n.state.isVisible?"none":"unset"},main:{backgroundColor:"transparent",boxShadow:"none",position:"absolute",top:0,left:0,height:"100% !important",width:"100% !important",maxHeight:"unset",maxWidth:"unset",overflow:"hidden"},scrollableContent:{width:"100% !important",height:"100% !important",maxHeight:"unset",maxWidth:"unset",overflow:"hidden"}}},i.createElement(o,Object(a.__assign)({},s,{onModalClose:n._onClose.bind(n),onShareReady:n._onShareReady.bind(n),setElementRef:n._setTopElementRef,setSharingHostMessenger:n._setSharingHostMessenger})));},n.state=A,n._initQos(),n;}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e;e=this.makeVisibleAgain,O&&!w&&(w=e);},t.prototype.componentWillUnmount=function(){E();},t.prototype.render=function(){var e;if(L||this.props.iFrameFullScreenOverride)return this._renderFullScreenShareIframe();if(null===(e=this.state)||void 0===e?void 0:e.isOpen){var t=this.props,n=t.sharingIFrameAs,o=void 0===n?x:n,s=Object(a.__rest)(t,["sharingIFrameAs"]);return i.createElement(r.e,{onDismiss:this._onClose,isOpen:!!this.state.isOpen,styles:{main:{maxWidth:"unset",maxHeight:"unset",minHeight:"unset"},scrollableContent:{overflow:"hidden"}}},i.createElement(o,Object(a.__assign)({},s,{onModalClose:this._onClose.bind(this),onShareReady:this._onShareReady.bind(this),setElementRef:this._setTopElementRef,setSharingHostMessenger:this._setSharingHostMessenger})));}return null;},t.prototype._initQos=function(){this._qos=new g.e({name:k,extraData:{clientId:this.props.getClientId()}});var e={name:k,resultType:g.t.Failure,resultCode:"Dialog not loaded in time"};this._qos.setTimeout(1e4,e);},t.prototype._setQosResult=function(e,t,n){this._qos&&(this._qos.end({resultType:e,resultCode:t,error:n}),this._qos=null);},t;}(i.PureComponent));}}]);